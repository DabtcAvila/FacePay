(()=>{var e={};e.id=7611,e.ids=[7611],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5773:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.a,__next_app__:()=>h,originalPathname:()=>u,pages:()=>d,routeModule:()=>m,tree:()=>c}),r(67017),r(79286),r(35866);var i=r(23191),a=r(88716),s=r(37922),n=r.n(s),o=r(95231),l={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);r.d(t,l);let c=["",{children:["biometric",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,67017)),"/Users/davicho/MASTER proyectos/FacePay/src/app/biometric/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,79286)),"/Users/davicho/MASTER proyectos/FacePay/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,35866,23)),"next/dist/client/components/not-found-error"]}],d=["/Users/davicho/MASTER proyectos/FacePay/src/app/biometric/page.tsx"],u="/biometric/page",h={require:r,loadChunk:()=>Promise.resolve()},m=new i.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/biometric/page",pathname:"/biometric",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},71888:(e,t,r)=>{Promise.resolve().then(r.bind(r,20172))},20172:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>l});var i=r(10326),a=r(17577),s=r(17602),n=r(91664),o=r(38443);function l(){let[e,t]=(0,a.useState)(null),[r,l]=(0,a.useState)(!1),[c,d]=(0,a.useState)([]),[u,h]=(0,a.useState)([]),[m,g]=(0,a.useState)("idle"),[p,x]=(0,a.useState)("idle"),[f,b]=(0,a.useState)(!1),[y,w]=(0,a.useState)(null),v=(e,t,r)=>{let i={timestamp:new Date().toISOString(),type:e,message:t,details:r};d(e=>[i,...e].slice(0,50))},D=async()=>{try{v("info","Loading existing credentials...");let e=localStorage.getItem("authToken")||y;if(!e){v("warning","No auth token available");return}let t=await fetch("/api/webauthn/credentials",{credentials:"include",headers:{Authorization:`Bearer ${e}`}});if(t.ok){let e=await t.json();e.success&&(h(e.data.credentials),v("success",`Loaded ${e.data.credentials.length} existing credentials`))}else v("warning","No existing credentials found or user not authenticated")}catch(e){v("error","Failed to load credentials",e)}},j=async()=>{if(!e?.isPlatformAuthenticatorAvailable){v("error","Platform authenticator not available");return}l(!0),g("registering");try{v("info","Starting biometric registration...");let e=localStorage.getItem("authToken")||y;if(!e){v("error","No auth token available");return}let t=await fetch("/api/webauthn/register-options",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`}});if(!t.ok)throw Error("Failed to get registration options");let r=await t.json();if(!r.success)throw Error(r.message||"Failed to get registration options");v("info","Registration options received, prompting for biometric..."),v("warning","\uD83D\uDD12 Your device will now prompt for biometric authentication (Face ID/Touch ID)");let i=await (0,s.RQ)(r.data);v("success","Biometric captured successfully, verifying with server...");let a=await fetch("/api/webauthn/register-verify",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({credential:i})});if(!a.ok)throw Error("Failed to verify registration");let n=await a.json();if(!n.success)throw Error(n.message||"Registration verification failed");g("success"),v("success","\uD83C\uDF89 Biometric registration completed successfully!",n.data),await D()}catch(e){g("error"),"NotAllowedError"===e.name?v("error","Biometric authentication was cancelled or denied by the user"):"NotSupportedError"===e.name?v("error","Biometric authentication is not supported on this device"):"SecurityError"===e.name?v("error","Security error: Make sure you are using HTTPS"):"InvalidStateError"===e.name?v("error","A credential for this device may already exist"):v("error",`Registration failed: ${e.message}`,e),console.error("Registration error:",e)}finally{l(!1),setTimeout(()=>g("idle"),3e3)}},N=async()=>{if(!e?.isPlatformAuthenticatorAvailable){v("error","Platform authenticator not available");return}if(0===u.length){v("error","No biometric credentials registered. Please register first.");return}l(!0),x("authenticating");try{v("info","Starting biometric authentication...");let e=localStorage.getItem("authToken")||y;if(!e){v("error","No auth token available");return}let t=await fetch("/api/webauthn/authenticate-options",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`}});if(!t.ok)throw Error("Failed to get authentication options");let r=await t.json();if(!r.success)throw Error(r.message||"Failed to get authentication options");v("info","Authentication options received, prompting for biometric..."),v("warning","\uD83D\uDD12 Your device will now prompt for biometric authentication");let i=await (0,s.oz)(r.data);v("success","Biometric verified successfully, validating with server...");let a=await fetch("/api/webauthn/authenticate-verify",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({credential:i})});if(!a.ok)throw Error("Failed to verify authentication");let n=await a.json();if(!n.success)throw Error(n.message||"Authentication verification failed");x("success"),v("success","\uD83C\uDF89 Biometric authentication successful!",n.data)}catch(e){x("error"),"NotAllowedError"===e.name?v("error","Biometric authentication was cancelled or denied by the user"):"NotSupportedError"===e.name?v("error","Biometric authentication is not supported on this device"):"SecurityError"===e.name?v("error","Security error: Make sure you are using HTTPS"):v("error",`Authentication failed: ${e.message}`,e),console.error("Authentication error:",e)}finally{l(!1),setTimeout(()=>x("idle"),3e3)}},A=async e=>{try{v("info",`Deleting credential: ${e}`);let t=localStorage.getItem("authToken")||y;if(!t){v("error","No auth token available");return}let r=await fetch(`/api/webauthn/credentials?credentialId=${encodeURIComponent(e)}`,{method:"DELETE",credentials:"include",headers:{Authorization:`Bearer ${t}`}});if(r.ok){let e=await r.json();e.success?(v("success","Credential deleted successfully"),await D()):v("error",e.message||"Failed to delete credential")}else v("error","Failed to delete credential")}catch(e){v("error","Error deleting credential",e)}},E=e=>{switch(e){case"success":return"bg-green-500";case"error":return"bg-red-500";case"registering":case"authenticating":return"bg-yellow-500";default:return"bg-gray-500"}};return i.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4",children:(0,i.jsxs)("div",{className:"max-w-4xl mx-auto space-y-6",children:[(0,i.jsxs)("div",{className:"text-center py-8",children:[(0,i.jsxs)("div",{className:"flex items-center justify-center space-x-2 mb-4",children:[i.jsx("h1",{className:"text-4xl font-bold text-gray-900",children:"\uD83D\uDD12 Real Biometric Authentication Demo"}),f&&i.jsx("div",{className:"bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-medium",children:"✅ Demo User Active"})]}),i.jsx("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto",children:"Experience genuine Face ID, Touch ID, and Windows Hello authentication using WebAuthn technology. This demo uses your device's actual biometric hardware - no simulations!"}),!f&&i.jsx("div",{className:"mt-4 bg-yellow-50 border border-yellow-200 rounded-lg p-3 max-w-md mx-auto",children:i.jsx("p",{className:"text-yellow-800 text-sm",children:"\uD83D\uDD04 Initializing demo session..."})})]}),(0,i.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[i.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-4 flex items-center",children:"\uD83D\uDCF1 Device Capabilities"}),e?(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"font-medium",children:"WebAuthn Support:"}),i.jsx(o.C,{className:e.isSupported?"bg-green-100 text-green-800":"bg-red-100 text-red-800",children:e.isSupported?"✅ Supported":"❌ Not Supported"})]}),(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"font-medium",children:"Platform Authenticator:"}),i.jsx(o.C,{className:e.isPlatformAuthenticatorAvailable?"bg-green-100 text-green-800":"bg-red-100 text-red-800",children:e.isPlatformAuthenticatorAvailable?"✅ Available":"❌ Not Available"})]}),(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"font-medium",children:"User Verification:"}),i.jsx(o.C,{className:e.isUserVerificationSupported?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800",children:e.isUserVerificationSupported?"✅ Supported":"⚠️ Limited"})]})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsxs)("div",{children:[i.jsx("span",{className:"font-medium",children:"Device Type:"}),(0,i.jsxs)("div",{className:"flex flex-wrap gap-1 mt-1",children:[e.deviceInfo.isIOS&&i.jsx(o.C,{className:"bg-blue-100 text-blue-800",children:"\uD83D\uDCF1 iOS"}),e.deviceInfo.isAndroid&&i.jsx(o.C,{className:"bg-green-100 text-green-800",children:"\uD83E\uDD16 Android"}),e.deviceInfo.isMacOS&&i.jsx(o.C,{className:"bg-gray-100 text-gray-800",children:"\uD83D\uDCBB macOS"}),e.deviceInfo.isWindows&&i.jsx(o.C,{className:"bg-blue-100 text-blue-800",children:"\uD83E\uDE9F Windows"}),e.deviceInfo.isMobile&&i.jsx(o.C,{className:"bg-purple-100 text-purple-800",children:"\uD83D\uDCF1 Mobile"})]})]}),(0,i.jsxs)("div",{children:[i.jsx("span",{className:"font-medium",children:"Available Biometrics:"}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:e.biometricTypes.length>0?(e=>{let t={face:"\uD83D\uDC64 Face ID",fingerprint:"\uD83D\uDC46 Touch ID / Fingerprint",voice:"\uD83D\uDDE3️ Voice Recognition",unknown:"\uD83D\uDD12 Platform Authenticator"};return e.map(e=>t[e]||e).join(", ")})(e.biometricTypes):"None detected"})]})]})]}),!e.isSupported&&i.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:(0,i.jsxs)("p",{className:"text-red-800",children:[i.jsx("strong",{children:"WebAuthn not supported:"})," Your browser doesn't support WebAuthn. Please try using a modern browser like Chrome, Firefox, Safari, or Edge."]})}),e.isSupported&&!e.isPlatformAuthenticatorAvailable&&i.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:(0,i.jsxs)("p",{className:"text-yellow-800",children:[i.jsx("strong",{children:"No biometric hardware detected:"})," Your device doesn't appear to have Face ID, Touch ID, or Windows Hello available."]})})]}):(0,i.jsxs)("div",{className:"flex items-center justify-center py-8",children:[i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),i.jsx("span",{className:"ml-2",children:"Checking capabilities..."})]})]}),(0,i.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[i.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-6 flex items-center",children:"\uD83D\uDE80 Biometric Actions"}),(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,i.jsxs)("div",{className:"space-y-2",children:[i.jsx(n.z,{onClick:j,disabled:!e?.isPlatformAuthenticatorAvailable||r,className:"w-full h-16 text-lg font-semibold bg-blue-600 hover:bg-blue-700 disabled:bg-gray-300",children:"registering"===m?(0,i.jsxs)(i.Fragment,{children:[i.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),"Registering Biometric..."]}):i.jsx(i.Fragment,{children:"\uD83D\uDD10 Register Face ID/Touch ID"})}),"idle"!==m&&(0,i.jsxs)("div",{className:`text-sm px-3 py-1 rounded-full text-white text-center ${E(m)}`,children:["registering"===m&&"Follow your device prompt...","success"===m&&"Registration successful! ✅","error"===m&&"Registration failed ❌"]})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[i.jsx(n.z,{onClick:N,disabled:!e?.isPlatformAuthenticatorAvailable||r||0===u.length,className:"w-full h-16 text-lg font-semibold bg-green-600 hover:bg-green-700 disabled:bg-gray-300",children:"authenticating"===p?(0,i.jsxs)(i.Fragment,{children:[i.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),"Authenticating..."]}):i.jsx(i.Fragment,{children:"\uD83D\uDD13 Authenticate with Biometric"})}),"idle"!==p&&(0,i.jsxs)("div",{className:`text-sm px-3 py-1 rounded-full text-white text-center ${E(p)}`,children:["authenticating"===p&&"Follow your device prompt...","success"===p&&"Authentication successful! ✅","error"===p&&"Authentication failed ❌"]})]})]}),0===u.length&&i.jsx("div",{className:"mt-4 bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,i.jsxs)("p",{className:"text-blue-800 text-sm",children:[i.jsx("strong",{children:"No biometric credentials registered."}),' Click "Register Face ID/Touch ID" to set up biometric authentication.']})})]}),u.length>0&&(0,i.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[(0,i.jsxs)("h2",{className:"text-2xl font-semibold text-gray-900 mb-4 flex items-center",children:["\uD83D\uDCBE Saved Credentials (",u.length,")"]}),i.jsx("div",{className:"space-y-3",children:u.map(e=>(0,i.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[(0,i.jsxs)("div",{className:"flex-1",children:[i.jsx("div",{className:"font-medium text-gray-900",children:e.friendlyName}),(0,i.jsxs)("div",{className:"text-sm text-gray-600",children:["Created: ",new Date(e.createdAt).toLocaleString()]}),(0,i.jsxs)("div",{className:"text-xs text-gray-500 font-mono",children:["ID: ",e.credentialId.substring(0,20),"..."]})]}),i.jsx(n.z,{onClick:()=>A(e.credentialId),variant:"outline",className:"text-red-600 border-red-300 hover:bg-red-50",size:"sm",children:"\uD83D\uDDD1️ Delete"})]},e.id))})]}),(0,i.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[i.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-4 flex items-center",children:"\uD83D\uDCDA How Real Biometric Authentication Works"}),(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,i.jsxs)("div",{children:[i.jsx("h3",{className:"text-lg font-semibold text-blue-600 mb-2",children:"\uD83D\uDD10 Registration Process"}),(0,i.jsxs)("ol",{className:"list-decimal list-inside space-y-1 text-sm text-gray-700",children:[i.jsx("li",{children:"Browser checks for biometric hardware availability"}),i.jsx("li",{children:"Server generates a unique cryptographic challenge"}),i.jsx("li",{children:"Your device prompts for Face ID/Touch ID/Windows Hello"}),i.jsx("li",{children:"Secure enclave creates a public-private key pair"}),i.jsx("li",{children:"Public key is sent to server (biometric data never leaves device)"}),i.jsx("li",{children:"Credential is stored for future authentication"})]})]}),(0,i.jsxs)("div",{children:[i.jsx("h3",{className:"text-lg font-semibold text-green-600 mb-2",children:"\uD83D\uDD13 Authentication Process"}),(0,i.jsxs)("ol",{className:"list-decimal list-inside space-y-1 text-sm text-gray-700",children:[i.jsx("li",{children:"Server sends authentication challenge"}),i.jsx("li",{children:"Browser requests biometric verification"}),i.jsx("li",{children:"You authenticate with Face ID/Touch ID/Windows Hello"}),i.jsx("li",{children:"Device signs the challenge with your private key"}),i.jsx("li",{children:"Server verifies the signature using your public key"}),i.jsx("li",{children:"Access granted if signature is valid"})]})]})]}),(0,i.jsxs)("div",{className:"mt-6 bg-blue-50 border border-blue-200 rounded-lg p-4",children:[i.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"\uD83D\uDD12 Security Features"}),(0,i.jsxs)("ul",{className:"text-sm text-blue-700 space-y-1",children:[(0,i.jsxs)("li",{children:["• ",i.jsx("strong",{children:"Privacy:"})," Your biometric data never leaves your device"]}),(0,i.jsxs)("li",{children:["• ",i.jsx("strong",{children:"Phishing Resistant:"})," Credentials are bound to specific domains"]}),(0,i.jsxs)("li",{children:["• ",i.jsx("strong",{children:"Replay Protection:"})," Each authentication uses a unique challenge"]}),(0,i.jsxs)("li",{children:["• ",i.jsx("strong",{children:"Device Security:"})," Keys are stored in secure hardware (Secure Enclave/TEE)"]}),(0,i.jsxs)("li",{children:["• ",i.jsx("strong",{children:"No Passwords:"})," Eliminates password-related vulnerabilities"]})]})]})]}),(0,i.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h2",{className:"text-2xl font-semibold text-gray-900 flex items-center",children:"\uD83D\uDCCA Real-time Logs"}),i.jsx(n.z,{onClick:()=>{d([]),v("info","Logs cleared")},variant:"outline",size:"sm",className:"text-gray-600",children:"\uD83E\uDDF9 Clear Logs"})]}),i.jsx("div",{className:"bg-gray-900 rounded-lg p-4 h-64 overflow-y-auto",children:0===c.length?i.jsx("p",{className:"text-gray-400 text-center",children:"No logs yet. Interact with the buttons above to see real-time updates."}):i.jsx("div",{className:"space-y-1",children:c.map((e,t)=>(0,i.jsxs)("div",{className:"text-sm font-mono",children:[i.jsx("span",{className:"text-gray-400",children:new Date(e.timestamp).toLocaleTimeString()})," ",(0,i.jsxs)("span",{className:"error"===e.type?"text-red-400":"success"===e.type?"text-green-400":"warning"===e.type?"text-yellow-400":"text-blue-400",children:["[",e.type.toUpperCase(),"]"]})," ",i.jsx("span",{className:"text-gray-100",children:e.message})]},t))})})]}),i.jsx("div",{className:"text-center py-4 text-gray-600",children:(0,i.jsxs)("p",{className:"text-sm",children:["This demo uses the ",i.jsx("strong",{children:"WebAuthn API"})," with real biometric hardware on your device.",i.jsx("br",{}),"Supported on iOS (Face ID/Touch ID), Android (Biometric), macOS (Touch ID), and Windows (Hello)."]})})]})})}},38443:(e,t,r)=>{"use strict";r.d(t,{C:()=>o});var i=r(10326);r(17577);var a=r(79360),s=r(51223);let n=(0,a.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function o({className:e,variant:t,...r}){return i.jsx("div",{className:(0,s.cn)(n({variant:t}),e),...r})}},67017:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>n,__esModule:()=>s,default:()=>o});var i=r(68570);let a=(0,i.createProxy)(String.raw`/Users/davicho/MASTER proyectos/FacePay/src/app/biometric/page.tsx`),{__esModule:s,$$typeof:n}=a;a.default;let o=(0,i.createProxy)(String.raw`/Users/davicho/MASTER proyectos/FacePay/src/app/biometric/page.tsx#default`)},17602:(e,t,r)=>{"use strict";function i(e){let t=new Uint8Array(e),r="";for(let e of t)r+=String.fromCharCode(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function a(e){let t=e.replace(/-/g,"+").replace(/_/g,"/"),r=(4-t.length%4)%4,i=atob(t.padEnd(t.length+r,"=")),a=new ArrayBuffer(i.length),s=new Uint8Array(a);for(let e=0;e<i.length;e++)s[e]=i.charCodeAt(e);return a}function s(){return window?.PublicKeyCredential!==void 0&&"function"==typeof window.PublicKeyCredential}function n(e){let{id:t}=e;return{...e,id:a(t),transports:e.transports}}function o(e){return"localhost"===e||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}r.d(t,{RQ:()=>m,oz:()=>p});class l extends Error{constructor({message:e,code:t,cause:r,name:i}){super(e,{cause:r}),this.name=i??r.name,this.code=t}}class c{createNewAbortSignal(){if(this.controller){let e=Error("Cancelling existing WebAuthn API call for new one");e.name="AbortError",this.controller.abort(e)}let e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){let e=Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}let d=new c,u=["cross-platform","platform"];function h(e){if(!(!e||0>u.indexOf(e)))return e}async function m(e){var t;let r,c,u,m,p;if(!s())throw Error("WebAuthn is not supported in this browser");let x={publicKey:{...e,challenge:a(e.challenge),user:{...e.user,id:(t=e.user.id,new TextEncoder().encode(t))},excludeCredentials:e.excludeCredentials?.map(n)}};x.signal=d.createNewAbortSignal();try{r=await navigator.credentials.create(x)}catch(e){throw function({error:e,options:t}){let{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if("AbortError"===e.name){if(t.signal instanceof AbortSignal)return new l({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if("ConstraintError"===e.name){if(r.authenticatorSelection?.requireResidentKey===!0)return new l({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(r.authenticatorSelection?.userVerification==="required")return new l({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else if("InvalidStateError"===e.name)return new l({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});else if("NotAllowedError"===e.name)return new l({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});else if("NotSupportedError"===e.name)return new l(0===r.pubKeyCredParams.filter(e=>"public-key"===e.type).length?{message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}:{message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});else if("SecurityError"===e.name){let t=window.location.hostname;if(!o(t))return new l({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e});if(r.rp.id!==t)return new l({message:`The RP ID "${r.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else if("TypeError"===e.name){if(r.user.id.byteLength<1||r.user.id.byteLength>64)return new l({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if("UnknownError"===e.name)return new l({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e});return e}({error:e,options:x})}if(!r)throw Error("Registration was not completed");let{id:f,rawId:b,response:y,type:w}=r;if("function"==typeof y.getTransports&&(u=y.getTransports()),"function"==typeof y.getPublicKeyAlgorithm)try{m=y.getPublicKeyAlgorithm()}catch(e){g("getPublicKeyAlgorithm()",e)}if("function"==typeof y.getPublicKey)try{let e=y.getPublicKey();null!==e&&(p=i(e))}catch(e){g("getPublicKey()",e)}if("function"==typeof y.getAuthenticatorData)try{c=i(y.getAuthenticatorData())}catch(e){g("getAuthenticatorData()",e)}return{id:f,rawId:i(b),response:{attestationObject:i(y.attestationObject),clientDataJSON:i(y.clientDataJSON),transports:u,publicKeyAlgorithm:m,publicKey:p,authenticatorData:c},type:w,clientExtensionResults:r.getClientExtensionResults(),authenticatorAttachment:h(r.authenticatorAttachment)}}function g(e,t){console.warn(`The browser extension that intercepted this WebAuthn API call incorrectly implemented ${e}. You should report this error to them.
`,t)}async function p(e,t=!1){let r,c,u;if(!s())throw Error("WebAuthn is not supported in this browser");e.allowCredentials?.length!==0&&(r=e.allowCredentials?.map(n));let m={...e,challenge:a(e.challenge),allowCredentials:r},g={};if(t){if(!await function(){let e=window.PublicKeyCredential;return void 0===e.isConditionalMediationAvailable?new Promise(e=>e(!1)):e.isConditionalMediationAvailable()}())throw Error("Browser does not support WebAuthn autofill");if(document.querySelectorAll("input[autocomplete$='webauthn']").length<1)throw Error('No <input> with "webauthn" as the only or last value in its `autocomplete` attribute was detected');g.mediation="conditional",m.allowCredentials=[]}g.publicKey=m,g.signal=d.createNewAbortSignal();try{c=await navigator.credentials.get(g)}catch(e){throw function({error:e,options:t}){let{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if("AbortError"===e.name){if(t.signal instanceof AbortSignal)return new l({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if("NotAllowedError"===e.name)return new l({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});else if("SecurityError"===e.name){let t=window.location.hostname;if(!o(t))return new l({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e});if(r.rpId!==t)return new l({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else if("UnknownError"===e.name)return new l({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e});return e}({error:e,options:g})}if(!c)throw Error("Authentication was not completed");let{id:p,rawId:x,response:f,type:b}=c;if(f.userHandle){var y;y=f.userHandle,u=new TextDecoder("utf-8").decode(y)}return{id:p,rawId:i(x),response:{authenticatorData:i(f.authenticatorData),clientDataJSON:i(f.clientDataJSON),signature:i(f.signature),userHandle:u},type:b,clientExtensionResults:c.getClientExtensionResults(),authenticatorAttachment:h(c.authenticatorAttachment)}}}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),i=t.X(0,[8948,1662,698],()=>r(5773));module.exports=i})();