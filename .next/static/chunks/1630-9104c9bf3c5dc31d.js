"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1630],{80233:function(e,t,a){a.d(t,{Z:function(){return i}});let i=(0,a(78030).Z)("camera",[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]])},76780:function(e,t,a){a.d(t,{Z:function(){return i}});let i=(0,a(78030).Z)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},92940:function(e,t,a){a.d(t,{Z:function(){return i}});let i=(0,a(78030).Z)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},58805:function(e,t,a){a.d(t,{Z:function(){return i}});let i=(0,a(78030).Z)("circle-stop",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["rect",{x:"9",y:"9",width:"6",height:"6",rx:"1",key:"1ssd4o"}]])},75733:function(e,t,a){a.d(t,{Z:function(){return i}});let i=(0,a(78030).Z)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},3274:function(e,t,a){a.d(t,{Z:function(){return i}});let i=(0,a(78030).Z)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},66706:function(e,t,a){a.d(t,{Z:function(){return i}});let i=(0,a(78030).Z)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},33907:function(e,t,a){a.d(t,{Z:function(){return i}});let i=(0,a(78030).Z)("sparkles",[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]])},48298:function(e,t,a){a.d(t,{Z:function(){return i}});let i=(0,a(78030).Z)("timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]])},71630:function(e,t,a){a.d(t,{Z:function(){return N}});var i=a(57437),r=a(2265),n=a(21513),c=a(34446),o=a(20500),l=a(3274),s=a(75733),d=a(61989),u=a(80233),m=a(33907),h=a(74697),g=a(92940),f=a(48298),p=a(58805),b=a(76780),v=a(66706);let y=(0,a(78030).Z)("wifi-off",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);var x=a(89733),k=a(45900),w=a(90896),j=a(21424);function N(e){let{userId:t="demo-user",userName:a="demo@example.com",onSuccess:N,onError:A,onCancel:E,mode:C="authentication",title:B="FacePay Authentication",subtitle:F,className:I="",showFallbackOptions:S=!0,preferredMethod:W}=e,[R,M]=(0,r.useState)(null),[Z,T]=(0,r.useState)("detecting"),[z,D]=(0,r.useState)("ready"),[O,L]=(0,r.useState)(0),[P,U]=(0,r.useState)(null),[_,V]=(0,r.useState)(!1),[q,H]=(0,r.useState)(!1),[G,K]=(0,r.useState)(!1),[Q,Y]=(0,r.useState)(""),[J,X]=(0,r.useState)(!1),[$,ee]=(0,r.useState)(0),[et,ea]=(0,r.useState)(!1),{toast:ei,success:er,error:en,warning:ec,info:eo,loading:el,dismiss:es,update:ed}=(0,w.p)(),eu=(0,r.useRef)(null),em=(0,r.useRef)(null),eh=(0,r.useRef)(null),eg=(0,r.useRef)(null),ef=(0,r.useRef)(null),ep=(0,r.useRef)(null),eb=(0,r.useCallback)(async()=>{try{D("ready"),U(null),H(!1),K(!1);let e=await (0,j.Fb)(k.G.checkBrowserCapabilities(),j.LS.QUICK_OPERATION,"Device capability check timed out","capabilities-check");M(e);let t="fallback";W?"biometric"===W&&e.isSupported&&e.isPlatformAuthenticatorAvailable?t="biometric":"camera"===W&&navigator.mediaDevices&&"function"==typeof navigator.mediaDevices.getUserMedia?t="camera":"demo"===W?(console.warn("[BiometricWithFallback] Demo mode requested but real biometric auth is preferred"),t=e.isSupported&&e.isPlatformAuthenticatorAvailable?"biometric":"camera"):t=W:e.isSupported&&e.isPlatformAuthenticatorAvailable?(t="biometric",console.log("[BiometricWithFallback] Auto-selected REAL biometric authentication")):navigator.mediaDevices&&"function"==typeof navigator.mediaDevices.getUserMedia?(t="camera",console.log("[BiometricWithFallback] Biometric not available, using camera fallback")):(console.warn("[BiometricWithFallback] No biometric methods available, using demo fallback"),t="demo"),T(t),V(!0),console.log("[BiometricWithFallback] Initialized with method:",t,{webauthnSupported:e.isSupported,platformAuthAvailable:e.isPlatformAuthenticatorAvailable,biometricTypes:e.biometricTypes,device:e.deviceInfo})}catch(e){(0,j.q4)(e)?(console.warn("[BiometricWithFallback] Initialization timed out, using demo fallback"),Y("Device check took too long. Using demo mode.")):console.warn("[BiometricWithFallback] Initialization failed, using demo fallback:",e),T("demo"),V(!0)}},[]),ev=(0,r.useCallback)(()=>{console.log("[BiometricWithFallback] Starting cleanup"),eh.current&&(console.log("[BiometricWithFallback] Stopping camera stream"),eh.current.getTracks().forEach(e=>{e.stop(),console.log("[BiometricWithFallback] Stopped track:",e.kind,e.readyState)}),eh.current=null),em.current&&(console.log("[BiometricWithFallback] Clearing video element"),em.current.srcObject=null,em.current.pause()),eg.current&&(console.log("[BiometricWithFallback] Clearing progress timer"),clearTimeout(eg.current),eg.current=null),ef.current&&(console.log("[BiometricWithFallback] Cancelling timeout handler"),ef.current.cancel(),ef.current=null),ep.current&&(console.log("[BiometricWithFallback] Aborting operations"),ep.current.abort(),ep.current=null),H(!1),K(!1),Y(""),console.log("[BiometricWithFallback] Cleanup completed")},[]);(0,r.useEffect)(()=>(eb(),()=>{console.log("[BiometricWithFallback] Component unmounting, running cleanup"),ev()}),[eb,ev]);let ey=(0,r.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3e3;console.log("[BiometricWithFallback] Starting progress animation, duration:",e),L(0);let t=Date.now(),a=()=>{let i=Math.min((Date.now()-t)/e*100,100);L(i),i<100?eg.current=setTimeout(a,50):(console.log("[BiometricWithFallback] Progress animation completed, setting success state"),D("success"))};a()},[]),ex=(0,r.useCallback)(async()=>{if(!(null==R?void 0:R.isPlatformAuthenticatorAvailable))throw Error("Biometric authentication not available");console.log("[BiometricWithFallback] Starting REAL biometric authentication - NO SIMULATION"),D("processing"),U(null),H(!1),K(!1),ep.current=new AbortController,ef.current=new j.Oo(()=>{H(!0),K(!0),Y((0,j.ld)("Real biometric authentication",j.LS.WEBAUTHN_OPERATION))},e=>L(e));try{let e,i;return console.log("[BiometricWithFallback] Executing REAL WebAuthn operation, mode:",C),"registration"===C?(console.log("[BiometricWithFallback] Starting REAL biometric registration..."),i=await ef.current.execute(()=>{var e;return k.G.register({userId:t,userName:a,userDisplayName:a},null===(e=ep.current)||void 0===e?void 0:e.signal)},j.LS.WEBAUTHN_OPERATION,"Real biometric registration timed out. Please try again.","webauthn-registration"),console.log("[BiometricWithFallback] REAL biometric registration completed successfully"),ey(1500),e={success:!0,method:"biometric",biometricType:R.biometricTypes[0]||"unknown",deviceInfo:{isIOS:R.deviceInfo.isIOS,isMobile:R.deviceInfo.isMobile,platform:R.deviceInfo.platform},timestamp:Date.now(),credentialId:i.id,verified:!0,type:"registration",realBiometric:!0}):(console.log("[BiometricWithFallback] Starting REAL biometric authentication..."),i=await ef.current.execute(()=>{var e;return k.G.authenticate({userId:t,email:a},null===(e=ep.current)||void 0===e?void 0:e.signal)},j.LS.WEBAUTHN_OPERATION,"Real biometric authentication timed out. Please try again.","webauthn-authentication"),console.log("[BiometricWithFallback] REAL biometric authentication completed successfully"),ey(1500),e={success:!0,method:"biometric",biometricType:R.biometricTypes[0]||"unknown",deviceInfo:{isIOS:R.deviceInfo.isIOS,isMobile:R.deviceInfo.isMobile,platform:R.deviceInfo.platform},timestamp:Date.now(),credentialId:i.id,verified:!0,type:"authentication",realBiometric:!0}),console.log("[BiometricWithFallback] REAL biometric operation completed successfully:",{method:e.method,type:e.type,credentialId:e.credentialId,realBiometric:e.realBiometric,timestamp:e.timestamp}),e}catch(t){console.error("[BiometricWithFallback] REAL biometric authentication failed:",t);let e=k.G.handleWebAuthnError(t);throw U(e),e}},[R,ey,C,t,a]),ek=(0,r.useCallback)(async()=>{console.log("[BiometricWithFallback] Starting camera authentication"),D("processing"),U(null),H(!1),K(!1),eh.current&&(console.log("[BiometricWithFallback] Cleaning up existing camera stream"),eh.current.getTracks().forEach(e=>{e.stop(),console.log("[BiometricWithFallback] Stopped track:",e.kind,e.readyState)}),eh.current=null),ep.current=new AbortController,ef.current=new j.Oo(()=>{H(!0),K(!0),Y((0,j.ld)("Camera initialization",j.LS.CAMERA_INIT))},e=>L(e));try{var e;if(!(null===(e=navigator.mediaDevices)||void 0===e?void 0:e.getUserMedia))throw Error("Camera not supported on this device");console.log("[BiometricWithFallback] Requesting camera access");let t=await ef.current.execute(async()=>{var e;let t=await navigator.mediaDevices.getUserMedia({video:{width:640,height:480,facingMode:"user"},audio:!1});if(null===(e=ep.current)||void 0===e?void 0:e.signal.aborted)throw t.getTracks().forEach(e=>e.stop()),Error("Camera initialization was cancelled");return t},j.LS.CAMERA_INIT,"Camera initialization timed out. Please check camera permissions.","camera-initialization");if(em.current&&t)console.log("[BiometricWithFallback] Setting up video element"),em.current.srcObject=t,eh.current=t,em.current.playsInline=!0,em.current.muted=!0,await new Promise((e,t)=>{let a=em.current,i=()=>{console.log("[BiometricWithFallback] Video metadata loaded"),a.removeEventListener("loadedmetadata",i),a.removeEventListener("error",r),e(!0)},r=e=>{console.error("[BiometricWithFallback] Video error:",e),a.removeEventListener("loadedmetadata",i),a.removeEventListener("error",r),t(Error("Video failed to load"))};a.addEventListener("loadedmetadata",i),a.addEventListener("error",r),a.play().catch(t)}),console.log("[BiometricWithFallback] Camera successfully initialized, starting face detection");else throw Error("Video element not available");return console.log("[BiometricWithFallback] Starting face detection simulation"),await ef.current.execute(async()=>new Promise(e=>{ey(4e3),setTimeout(e,4e3)}),j.LS.FACE_DETECTION,"Face detection timed out. Please ensure your face is visible and well-lit.","face-detection"),{success:!0,method:"camera",deviceInfo:{isIOS:(null==R?void 0:R.deviceInfo.isIOS)||!1,isMobile:(null==R?void 0:R.deviceInfo.isMobile)||!1,platform:(null==R?void 0:R.deviceInfo.platform)||"unknown"},timestamp:Date.now()}}catch(t){let e;throw console.error("[BiometricWithFallback] Camera authentication failed:",t),eh.current&&(eh.current.getTracks().forEach(e=>e.stop()),eh.current=null),U(e=(0,j.q4)(t)?{code:"CAMERA_TIMEOUT",message:t.message,isRecoverable:!0,suggestedAction:"Camera operation timed out. Please try again or use demo mode."}:{code:"CAMERA_ERROR",message:t instanceof Error?t.message:"Camera access failed",isRecoverable:!0,suggestedAction:"Please allow camera access or try demo mode"}),e}},[R,ey,ev]),ew=(0,r.useCallback)(async()=>(D("processing"),U(null),H(!1),K(!1),ep.current=new AbortController,ef.current=new j.Oo(()=>{H(!0),K(!0),Y("Demo is taking longer than usual...")},e=>L(e)),await ef.current.execute(async()=>new Promise(e=>{ey(3500),setTimeout(e,3500)}),2*j.LS.QUICK_OPERATION,"Demo timed out unexpectedly.","demo-authentication"),{success:!0,method:"demo",deviceInfo:{isIOS:(null==R?void 0:R.deviceInfo.isIOS)||!1,isMobile:(null==R?void 0:R.deviceInfo.isMobile)||!1,platform:(null==R?void 0:R.deviceInfo.platform)||"demo"},timestamp:Date.now()}),[R,ey]),ej=(0,r.useCallback)(async e=>{let t=e||Z;if(J){ec("Authentication in progress","Please wait for the current authentication to complete.");return}try{let e;switch(ee(e=>e+1),X(!0),et&&console.log("[BiometricWithFallback] Starting authentication with method:",t,{retryCount:$+1}),t){case"biometric":e=await ex();break;case"camera":e=await ek();break;case"demo":e=await ew();break;default:throw Error("Invalid authentication method: ".concat(t))}X(!1),ee(0),eu.current&&es(eu.current);let a="biometric"===e.method?"face"===e.biometricType?"Real Face ID":"Real Touch ID":"camera"===e.method?"Camera Scan":"Visual Demo",i=e.realBiometric?"".concat(a," authentication completed successfully - REAL biometric verification used!"):"".concat(a," authentication completed successfully.");er("Real Authentication Successful!",i),et&&console.log("[BiometricWithFallback] Authentication successful:",e),setTimeout(()=>{et&&console.log("[BiometricWithFallback] Calling onSuccess callback"),null==N||N(e)},2e3)}catch(e){X(!1),et&&console.error("[BiometricWithFallback] Authentication failed:",e),"demo"!==t&&$<2?(console.log("[BiometricWithFallback] Method failed, falling back to demo:",e),ec("Switching to backup method","".concat(t," authentication failed. Switching to Visual Demo as backup.")),T("demo"),setTimeout(()=>ej("demo"),2e3)):(D("error"),eu.current&&es(eu.current),null==A||A(e))}},[Z,ex,ek,ew,N,A,J,$,et,ec,er,es]),eN=(0,r.useCallback)(e=>{console.log("[BiometricWithFallback] Switching method from",Z,"to",e),ev(),setTimeout(()=>{T(e),D("ready"),U(null),L(0),console.log("[BiometricWithFallback] Method switched to:",e)},100)},[ev,Z]),eA=(0,r.useCallback)(()=>{console.log("[BiometricWithFallback] Cancelling current operation"),ef.current&&ef.current.cancel(),ep.current&&ep.current.abort(),ev(),D("ready"),U(null),L(0),H(!1),K(!1),Y(""),console.log("[BiometricWithFallback] Operation cancelled successfully")},[ev]),eE=(0,r.useCallback)(()=>{if(!R)return{icon:o.Z,name:"Loading...",description:"Checking capabilities..."};switch(Z){case"detecting":return{icon:l.Z,name:"Detecting...",description:"Checking device capabilities"};case"biometric":let e=R.biometricTypes[0];return{icon:"face"===e?s.Z:d.Z,name:R.deviceInfo.isIOS?"face"===e?"Face ID":"Touch ID":"face"===e?"Face Recognition":"Biometric",description:"Use your ".concat("face"===e?"face":"fingerprint"," to authenticate securely")};case"camera":return{icon:u.Z,name:"Camera Scan",description:"Look into the camera for face detection"};case"demo":return{icon:m.Z,name:"Visual Demo",description:"Experience how biometric authentication works"};default:return{icon:o.Z,name:"Authentication",description:"Choose your preferred method"}}},[R,Z])();return _?(0,i.jsxs)("div",{className:"w-full max-w-lg mx-auto p-6 ".concat(I),children:[(0,i.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:B}),F&&(0,i.jsx)("p",{className:"text-gray-600 text-sm mt-1",children:F})]}),E&&(0,i.jsx)(x.z,{onClick:E,variant:"ghost",size:"sm",children:(0,i.jsx)(h.Z,{className:"w-5 h-5"})})]}),(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsxs)("div",{className:"relative",children:["camera"===Z&&(0,i.jsxs)("div",{className:"relative mb-4",children:[(0,i.jsx)("video",{ref:em,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-64 object-cover rounded-lg",style:{display:eh.current?"block":"none"},onError:e=>{console.error("[BiometricWithFallback] Video error:",e),U({code:"CAMERA_ERROR",message:"Video playback failed",isRecoverable:!0,suggestedAction:"Please try demo mode"})},onLoadedMetadata:()=>{console.log("[BiometricWithFallback] Video metadata loaded")}}),!eh.current&&"camera"===Z&&(0,i.jsx)("div",{className:"w-full h-64 bg-gray-200 rounded-lg flex items-center justify-center",children:(0,i.jsxs)("div",{className:"text-center text-gray-600",children:[(0,i.jsx)(u.Z,{className:"w-12 h-12 mx-auto mb-2"}),(0,i.jsx)("p",{children:"Initializing camera..."})]})}),eh.current&&(0,i.jsx)("button",{onClick:()=>{console.log("[BiometricWithFallback] User cancelled camera"),ev(),eN("demo")},className:"absolute top-2 right-2 bg-red-500 hover:bg-red-600 text-white p-2 rounded-full shadow-lg transition-colors",children:(0,i.jsx)(h.Z,{className:"w-4 h-4"})})]}),(0,i.jsxs)("div",{className:"relative bg-gradient-to-br from-blue-900 to-purple-900 rounded-2xl aspect-square flex items-center justify-center overflow-hidden",children:[(0,i.jsx)(n.E.div,{className:"relative z-10",animate:{scale:"processing"===z?[1,1.05,1]:1,rotate:eE.icon===l.Z?[0,360]:0},transition:{scale:{duration:2,repeat:"processing"===z?1/0:0},rotate:{duration:2,repeat:eE.icon===l.Z?1/0:0,ease:"linear"}},children:(0,i.jsx)("div",{className:"w-24 h-24 bg-blue-500/20 rounded-full flex items-center justify-center backdrop-blur",children:(0,i.jsx)(eE.icon,{className:"w-12 h-12 text-blue-300"})})}),"processing"===z&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.E.div,{className:"absolute inset-8 border-2 border-blue-400 rounded-full",animate:{scale:[1,1.1,1],opacity:[.5,1,.5]},transition:{duration:2,repeat:1/0}}),(0,i.jsx)(n.E.div,{className:"absolute inset-12 border border-blue-300 rounded-full",animate:{rotate:360},transition:{duration:3,repeat:1/0,ease:"linear"}})]}),"success"===z&&(0,i.jsxs)(n.E.div,{className:"absolute inset-0 bg-green-500/20 rounded-2xl flex items-center justify-center overflow-hidden",initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{type:"spring",stiffness:200,damping:15},children:[(0,i.jsx)(n.E.div,{className:"absolute inset-0 bg-gradient-to-r from-green-400/30 to-emerald-400/30 rounded-2xl",initial:{scale:0,opacity:0},animate:{scale:[0,1.5,2],opacity:[.8,.4,0]},transition:{duration:1.2,ease:"easeOut"}}),(0,i.jsx)(n.E.div,{initial:{scale:0,rotate:-90},animate:{scale:1,rotate:0},transition:{type:"spring",stiffness:300,damping:20,delay:.1},children:(0,i.jsx)(g.Z,{className:"w-16 h-16 text-green-400 relative z-10"})})]}),"processing"===z&&(0,i.jsx)(n.E.div,{className:"absolute left-8 right-8 h-0.5 bg-gradient-to-r from-transparent via-blue-400 to-transparent",animate:{y:[32,"75%"]},transition:{duration:2,repeat:1/0,ease:"linear"}})]}),"processing"===z&&(0,i.jsxs)("div",{className:"mt-4",children:[(0,i.jsx)("div",{className:"bg-gray-200 rounded-full h-2",children:(0,i.jsx)(n.E.div,{className:"h-full bg-gradient-to-r from-blue-500 to-purple-600 rounded-full",initial:{width:"0%"},animate:{width:"".concat(O,"%")},transition:{duration:.3}})}),(0,i.jsxs)("div",{className:"text-center mt-2",children:[(0,i.jsxs)("p",{className:"text-sm font-medium text-blue-600",children:[Math.round(O),"% Complete"]}),q&&(0,i.jsxs)("p",{className:"text-xs text-yellow-600 mt-1 flex items-center justify-center",children:[(0,i.jsx)(f.Z,{className:"w-3 h-3 mr-1"}),"Taking longer than expected..."]})]})]})]}),"error"===z?(0,i.jsxs)("div",{className:"text-center space-y-4",children:[(0,i.jsxs)("div",{className:"flex items-center justify-center space-x-3 text-red-500",children:[(0,i.jsx)(b.Z,{className:"w-8 h-8"}),(0,i.jsx)("h3",{className:"text-xl font-semibold",children:"Authentication Failed"})]}),(0,i.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[(0,i.jsx)("p",{className:"text-red-700 font-medium",children:null==P?void 0:P.message}),(0,i.jsx)("p",{className:"text-red-600 text-sm mt-1",children:null==P?void 0:P.suggestedAction})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(null==P?void 0:P.isRecoverable)&&(0,i.jsx)(x.z,{onClick:()=>{console.log("[BiometricWithFallback] Retrying authentication"),ev(),setTimeout(()=>{U(null),D("ready"),ej()},500)},disabled:J,className:"flex items-center gap-2 disabled:opacity-50",children:J?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(l.Z,{className:"w-4 h-4 animate-spin"}),"Retrying..."]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(v.Z,{className:"w-4 h-4"}),"Try Again ",$>0&&"(".concat($,")")]})}),(0,i.jsxs)(x.z,{onClick:()=>eN("demo"),variant:"outline",disabled:J||"demo"===Z,className:"flex items-center gap-2 disabled:opacity-50",children:[(0,i.jsx)(m.Z,{className:"w-4 h-4"}),"Use Visual Demo"]})]})]}):(0,i.jsxs)("div",{className:"text-center space-y-4",children:[(0,i.jsxs)("h3",{className:"text-xl font-semibold text-gray-900",children:["ready"===z&&eE.name,"processing"===z&&"".concat("registration"===C?"Registering":"Authenticating","..."),"success"===z&&"Success!","error"===z&&"Authentication Failed"]}),(0,i.jsxs)("p",{className:"text-gray-600",children:["ready"===z&&eE.description,"processing"===z&&!q&&"Please follow the prompts on your device","processing"===z&&q&&(Q||"Operation is taking longer than expected..."),"success"===z&&"".concat("registration"===C?"Registration":"Authentication"," completed successfully"),"error"===z&&(null==P?void 0:P.message)]}),"processing"===z&&G&&(0,i.jsxs)(x.z,{onClick:eA,variant:"outline",className:"flex items-center gap-2",children:[(0,i.jsx)(p.Z,{className:"w-4 h-4"}),"Cancel Operation"]}),"ready"===z&&(0,i.jsx)(x.z,{onClick:()=>ej(),disabled:J,className:"bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 disabled:opacity-50 disabled:cursor-not-allowed",size:"lg",children:J?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(l.Z,{className:"w-4 h-4 mr-2 animate-spin"}),"Processing..."]}):"registration"===C?"Register":"Authenticate"}),"processing"===z&&(0,i.jsxs)(x.z,{onClick:()=>{console.log("[BiometricWithFallback] User cancelled during processing"),ev(),D("ready"),U(null)},variant:"outline",size:"sm",className:"flex items-center gap-2 text-red-600 border-red-200 hover:bg-red-50",children:[(0,i.jsx)(h.Z,{className:"w-4 h-4"}),"Cancel"]}),"ready"===z&&S&&(S?(0,i.jsxs)("div",{className:"flex flex-wrap gap-2 justify-center",children:[(0,i.jsxs)(x.z,{onClick:()=>eN("demo"),variant:"demo"===Z?"default":"outline",size:"sm",disabled:J,className:"flex items-center gap-2 disabled:opacity-50",children:[(0,i.jsx)(m.Z,{className:"w-4 h-4"}),"Visual Demo"]}),(null==R?void 0:R.isPlatformAuthenticatorAvailable)&&(0,i.jsxs)(x.z,{onClick:()=>eN("biometric"),variant:"biometric"===Z?"default":"outline",size:"sm",disabled:J,className:"flex items-center gap-2 disabled:opacity-50",children:[R.biometricTypes.includes("face")?(0,i.jsx)(s.Z,{className:"w-4 h-4"}):(0,i.jsx)(d.Z,{className:"w-4 h-4"}),R.deviceInfo.isIOS?"Device ID":"Biometrics"]}),"undefined"!=typeof navigator&&navigator.mediaDevices&&"function"==typeof navigator.mediaDevices.getUserMedia&&(0,i.jsxs)(x.z,{onClick:()=>eN("camera"),variant:"camera"===Z?"default":"outline",size:"sm",disabled:J,className:"flex items-center gap-2 disabled:opacity-50",children:[(0,i.jsx)(u.Z,{className:"w-4 h-4"}),"Camera"]})]}):null)]})]}),(0,i.jsxs)("div",{className:"mt-6 flex justify-center items-center space-x-4 text-sm text-gray-500",children:[R&&(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)("div",{className:"w-2 h-2 rounded-full ".concat(R.isPlatformAuthenticatorAvailable?"bg-green-500":"bg-yellow-500")}),(0,i.jsx)("span",{children:R.isPlatformAuthenticatorAvailable?"Biometrics Ready":"Demo Mode"})]}),!navigator.onLine&&(0,i.jsxs)("div",{className:"flex items-center space-x-2 text-blue-600",children:[(0,i.jsx)(y,{className:"w-4 h-4"}),(0,i.jsx)("span",{children:"Offline Mode"})]})]}),(0,i.jsx)(c.M,{children:"success"===z&&(0,i.jsxs)(n.E.div,{initial:{opacity:0,y:20,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-20,scale:.9},transition:{type:"spring",stiffness:300,damping:25,opacity:{duration:.3},scale:{duration:.4}},className:"mt-6 p-6 bg-gradient-to-br from-green-50 to-emerald-50 border border-green-200 rounded-2xl text-center relative overflow-hidden",children:[(0,i.jsx)(n.E.div,{initial:{scale:0,opacity:0},animate:{scale:[0,1.2,1],opacity:[0,.3,0]},transition:{duration:1.5,ease:"easeOut"},className:"absolute inset-0 bg-gradient-to-r from-green-400 to-emerald-400 rounded-2xl"}),(0,i.jsx)(n.E.div,{initial:{scale:0,rotate:-180},animate:{scale:1,rotate:0},transition:{type:"spring",stiffness:200,damping:15,delay:.2},children:(0,i.jsx)(g.Z,{className:"w-12 h-12 text-green-500 mx-auto mb-4 relative z-10"})}),(0,i.jsx)(n.E.h3,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.4,duration:.3},className:"text-lg font-bold text-green-800 mb-2 relative z-10",children:"registration"===C?"Registration Complete!":"Authentication Successful!"}),(0,i.jsx)(n.E.p,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.6,duration:.3},className:"text-green-700 relative z-10",children:"demo"===Z?"This was a demonstration of how biometric authentication would work.":"biometric"===Z?"REAL biometric authentication completed! Your Face ID/Touch ID was successfully verified.":"You can now proceed with secure transactions."}),(0,i.jsx)(n.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.8,duration:.3},className:"mt-4 relative z-10",children:(0,i.jsxs)("div",{className:"flex items-center justify-center space-x-2 text-green-600",children:[(0,i.jsx)(n.E.div,{animate:{rotate:360},transition:{duration:2,repeat:1/0,ease:"linear"},children:(0,i.jsx)(g.Z,{className:"w-4 h-4"})}),(0,i.jsx)("span",{className:"text-sm font-medium",children:"Redirecting to payment..."})]})}),(0,i.jsx)("div",{className:"absolute inset-0 pointer-events-none",children:Array.from({length:8},(e,t)=>(0,i.jsx)(n.E.div,{className:"absolute w-1 h-1 bg-green-400 rounded-full",initial:{x:"50%",y:"50%",scale:0,opacity:0},animate:{x:"".concat(30+40*Math.random(),"%"),y:"".concat(20+60*Math.random(),"%"),scale:[0,1,0],opacity:[0,1,0]},transition:{duration:1.5,delay:.5+.5*Math.random(),ease:"easeOut"}},t))})]})})]}):(0,i.jsx)("div",{className:"w-full max-w-lg mx-auto p-6 ".concat(I),children:(0,i.jsxs)("div",{className:"flex flex-col items-center justify-center space-y-4",children:[(0,i.jsx)(l.Z,{className:"w-12 h-12 text-blue-600 animate-spin"}),(0,i.jsx)("p",{className:"text-gray-600",children:"Initializing authentication..."})]})})}},89733:function(e,t,a){a.d(t,{z:function(){return s}});var i=a(57437),r=a(2265),n=a(92974),c=a(13027),o=a(49354);let l=(0,c.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),s=r.forwardRef((e,t)=>{let{className:a,variant:r,size:c,asChild:s=!1,...d}=e,u=s?n.g7:"button";return(0,i.jsx)(u,{className:(0,o.cn)(l({variant:r,size:c,className:a})),ref:t,...d})});s.displayName="Button"},90896:function(e,t,a){a.d(t,{p:function(){return m}});var i=a(2265),r=a(49354);let n=[],c=new Set,o=()=>{c.forEach(e=>e(n))},l=e=>{let t=(0,r.Le)(),a={id:t,timestamp:Date.now(),duration:5e3,...e};return n=[a,...n].slice(0,5),o(),!a.persistent&&a.duration&&a.duration>0&&setTimeout(()=>{s(t)},a.duration),t},s=e=>{n=n.filter(t=>t.id!==e),o()},d=(e,t)=>{n=n.map(a=>a.id===e?{...a,...t}:a),o()},u=()=>{n=[],o()};function m(){let[e,t]=(0,i.useState)(n),a=(0,i.useRef)();i.useEffect(()=>(a.current=t,c.add(a.current),()=>{a.current&&c.delete(a.current)}),[]);let r=(0,i.useCallback)(e=>l(e),[]),o=(0,i.useCallback)(function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return l({title:e,description:t,variant:"success",...a})},[]),m=(0,i.useCallback)(function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return l({title:e,description:t,variant:"error",duration:8e3,...a})},[]),h=(0,i.useCallback)(function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return l({title:e,description:t,variant:"warning",duration:6e3,...a})},[]),g=(0,i.useCallback)(function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return l({title:e,description:t,variant:"info",...a})},[]),f=(0,i.useCallback)(function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return l({title:e,description:t,variant:"loading",persistent:!0,...a})},[]);return{toasts:e,toast:r,success:o,error:m,warning:h,info:g,loading:f,dismiss:(0,i.useCallback)(e=>{s(e)},[]),dismissAll:(0,i.useCallback)(()=>{u()},[]),update:(0,i.useCallback)((e,t)=>{d(e,t)},[])}}},49354:function(e,t,a){a.d(t,{Le:function(){return c},cn:function(){return n}});var i=a(44839),r=a(96164);function n(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,r.m6)((0,i.W)(t))}function c(){return crypto.randomUUID()}}}]);