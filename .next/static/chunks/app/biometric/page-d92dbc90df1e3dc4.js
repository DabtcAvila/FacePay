(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[611],{32020:function(e,t,i){Promise.resolve().then(i.bind(i,11912))},11912:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return l}});var r=i(57437),a=i(2265),s=i(74550),n=i(50362),o=i(79055);function l(){let[e,t]=(0,a.useState)(null),[i,l]=(0,a.useState)(!1),[c,d]=(0,a.useState)([]),[u,h]=(0,a.useState)([]),[m,g]=(0,a.useState)("idle"),[x,p]=(0,a.useState)("idle"),[b,f]=(0,a.useState)(!1),[v,w]=(0,a.useState)(null),y=(e,t,i)=>{let r={timestamp:new Date().toISOString(),type:e,message:t,details:i};d(e=>[r,...e].slice(0,50))},j=async()=>{y("info","Checking browser capabilities...");try{let e=navigator.userAgent.toLowerCase(),i=navigator.platform.toLowerCase(),r=/iphone|ipad|ipod/.test(e)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1,a=/android/.test(e),s=/mac/.test(i)&&!r,n=/win/.test(i),o=r||a||/mobile/.test(e),l=!!(window.PublicKeyCredential&&navigator.credentials&&navigator.credentials.create),c=!1,d=!1,u=[];if(l&&(c=await PublicKeyCredential.isUserVerifyingPlatformAuthenticatorAvailable(),"function"==typeof window.PublicKeyCredential.isConditionalMediationAvailable&&(d=await PublicKeyCredential.isConditionalMediationAvailable()),c)){if(r){let e=window.screen.height/window.screen.width>2.1;u=e?["face"]:["fingerprint"],y("info","iOS device detected with ".concat(e?"Face ID":"Touch ID"," capability"))}else a?(u=["fingerprint","face"],y("info","Android device detected with fingerprint/face biometric capabilities")):s?(u=["fingerprint"],y("info","macOS device detected with Touch ID capability")):n?(u=["fingerprint","face"],y("info","Windows device detected with Windows Hello capabilities")):(u=["unknown"],y("warning","Unknown device type, biometric capabilities uncertain"))}let h={isSupported:l,isPlatformAuthenticatorAvailable:c,isUserVerificationSupported:d,biometricTypes:u,deviceInfo:{platform:navigator.platform,userAgent:navigator.userAgent,isMobile:o,isIOS:r,isAndroid:a,isMacOS:s,isWindows:n}};t(h),y("success","Capabilities check completed",h),l?c?y("success","Biometric authentication available: ".concat(u.join(", "))):y("warning","Platform authenticator not available - biometric authentication may not work"):y("error","WebAuthn not supported in this browser")}catch(e){y("error","Failed to check capabilities",e),console.error("Capabilities check error:",e)}},D=async()=>{try{y("info","Loading existing credentials...");let e=localStorage.getItem("authToken")||v;if(!e){y("warning","No auth token available");return}let t=await fetch("/api/webauthn/credentials",{credentials:"include",headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){let e=await t.json();e.success&&(h(e.data.credentials),y("success","Loaded ".concat(e.data.credentials.length," existing credentials")))}else y("warning","No existing credentials found or user not authenticated")}catch(e){y("error","Failed to load credentials",e)}},N=async()=>{if(!(null==e?void 0:e.isPlatformAuthenticatorAvailable)){y("error","Platform authenticator not available");return}l(!0),g("registering");try{y("info","Starting biometric registration...");let e=localStorage.getItem("authToken")||v;if(!e){y("error","No auth token available");return}let t=await fetch("/api/webauthn/register-options",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}});if(!t.ok)throw Error("Failed to get registration options");let i=await t.json();if(!i.success)throw Error(i.message||"Failed to get registration options");y("info","Registration options received, prompting for biometric..."),y("warning","\uD83D\uDD12 Your device will now prompt for biometric authentication (Face ID/Touch ID)");let r=await (0,s.RQ)(i.data);y("success","Biometric captured successfully, verifying with server...");let a=await fetch("/api/webauthn/register-verify",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({credential:r})});if(!a.ok)throw Error("Failed to verify registration");let n=await a.json();if(!n.success)throw Error(n.message||"Registration verification failed");g("success"),y("success","\uD83C\uDF89 Biometric registration completed successfully!",n.data),await D()}catch(e){g("error"),"NotAllowedError"===e.name?y("error","Biometric authentication was cancelled or denied by the user"):"NotSupportedError"===e.name?y("error","Biometric authentication is not supported on this device"):"SecurityError"===e.name?y("error","Security error: Make sure you are using HTTPS"):"InvalidStateError"===e.name?y("error","A credential for this device may already exist"):y("error","Registration failed: ".concat(e.message),e),console.error("Registration error:",e)}finally{l(!1),setTimeout(()=>g("idle"),3e3)}},A=async()=>{if(!(null==e?void 0:e.isPlatformAuthenticatorAvailable)){y("error","Platform authenticator not available");return}if(0===u.length){y("error","No biometric credentials registered. Please register first.");return}l(!0),p("authenticating");try{y("info","Starting biometric authentication...");let e=localStorage.getItem("authToken")||v;if(!e){y("error","No auth token available");return}let t=await fetch("/api/webauthn/authenticate-options",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}});if(!t.ok)throw Error("Failed to get authentication options");let i=await t.json();if(!i.success)throw Error(i.message||"Failed to get authentication options");y("info","Authentication options received, prompting for biometric..."),y("warning","\uD83D\uDD12 Your device will now prompt for biometric authentication");let r=await (0,s.oz)(i.data);y("success","Biometric verified successfully, validating with server...");let a=await fetch("/api/webauthn/authenticate-verify",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({credential:r})});if(!a.ok)throw Error("Failed to verify authentication");let n=await a.json();if(!n.success)throw Error(n.message||"Authentication verification failed");p("success"),y("success","\uD83C\uDF89 Biometric authentication successful!",n.data)}catch(e){p("error"),"NotAllowedError"===e.name?y("error","Biometric authentication was cancelled or denied by the user"):"NotSupportedError"===e.name?y("error","Biometric authentication is not supported on this device"):"SecurityError"===e.name?y("error","Security error: Make sure you are using HTTPS"):y("error","Authentication failed: ".concat(e.message),e),console.error("Authentication error:",e)}finally{l(!1),setTimeout(()=>p("idle"),3e3)}},S=async e=>{try{y("info","Deleting credential: ".concat(e));let t=localStorage.getItem("authToken")||v;if(!t){y("error","No auth token available");return}let i=await fetch("/api/webauthn/credentials?credentialId=".concat(encodeURIComponent(e)),{method:"DELETE",credentials:"include",headers:{Authorization:"Bearer ".concat(t)}});if(i.ok){let e=await i.json();e.success?(y("success","Credential deleted successfully"),await D()):y("error",e.message||"Failed to delete credential")}else y("error","Failed to delete credential")}catch(e){y("error","Error deleting credential",e)}},C=async()=>{try{y("info","Logging in with demo user...");let e=await fetch("/api/auth/demo-login",{method:"POST",credentials:"include"});if(e.ok){let t=await e.json();t.success?(w(t.data.tokens.accessToken),f(!0),y("success","Logged in as ".concat(t.data.user.name," (").concat(t.data.user.email,")")),localStorage.setItem("authToken",t.data.tokens.accessToken)):y("error","Demo login failed",t.error)}else y("error","Demo login request failed")}catch(e){y("error","Error during demo login",e)}};(0,a.useEffect)(()=>{(async()=>{await C(),await j()})()},[]),(0,a.useEffect)(()=>{b&&D()},[b]);let k=e=>{switch(e){case"success":return"bg-green-500";case"error":return"bg-red-500";case"registering":case"authenticating":return"bg-yellow-500";default:return"bg-gray-500"}};return(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4",children:(0,r.jsxs)("div",{className:"max-w-4xl mx-auto space-y-6",children:[(0,r.jsxs)("div",{className:"text-center py-8",children:[(0,r.jsxs)("div",{className:"flex items-center justify-center space-x-2 mb-4",children:[(0,r.jsx)("h1",{className:"text-4xl font-bold text-gray-900",children:"\uD83D\uDD12 Real Biometric Authentication Demo"}),b&&(0,r.jsx)("div",{className:"bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-medium",children:"✅ Demo User Active"})]}),(0,r.jsx)("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto",children:"Experience genuine Face ID, Touch ID, and Windows Hello authentication using WebAuthn technology. This demo uses your device's actual biometric hardware - no simulations!"}),!b&&(0,r.jsx)("div",{className:"mt-4 bg-yellow-50 border border-yellow-200 rounded-lg p-3 max-w-md mx-auto",children:(0,r.jsx)("p",{className:"text-yellow-800 text-sm",children:"\uD83D\uDD04 Initializing demo session..."})})]}),(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[(0,r.jsx)("h2",{className:"text-2xl font-semibold text-gray-900 mb-4 flex items-center",children:"\uD83D\uDCF1 Device Capabilities"}),e?(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{className:"font-medium",children:"WebAuthn Support:"}),(0,r.jsx)(o.C,{className:e.isSupported?"bg-green-100 text-green-800":"bg-red-100 text-red-800",children:e.isSupported?"✅ Supported":"❌ Not Supported"})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{className:"font-medium",children:"Platform Authenticator:"}),(0,r.jsx)(o.C,{className:e.isPlatformAuthenticatorAvailable?"bg-green-100 text-green-800":"bg-red-100 text-red-800",children:e.isPlatformAuthenticatorAvailable?"✅ Available":"❌ Not Available"})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{className:"font-medium",children:"User Verification:"}),(0,r.jsx)(o.C,{className:e.isUserVerificationSupported?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800",children:e.isUserVerificationSupported?"✅ Supported":"⚠️ Limited"})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-medium",children:"Device Type:"}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-1 mt-1",children:[e.deviceInfo.isIOS&&(0,r.jsx)(o.C,{className:"bg-blue-100 text-blue-800",children:"\uD83D\uDCF1 iOS"}),e.deviceInfo.isAndroid&&(0,r.jsx)(o.C,{className:"bg-green-100 text-green-800",children:"\uD83E\uDD16 Android"}),e.deviceInfo.isMacOS&&(0,r.jsx)(o.C,{className:"bg-gray-100 text-gray-800",children:"\uD83D\uDCBB macOS"}),e.deviceInfo.isWindows&&(0,r.jsx)(o.C,{className:"bg-blue-100 text-blue-800",children:"\uD83E\uDE9F Windows"}),e.deviceInfo.isMobile&&(0,r.jsx)(o.C,{className:"bg-purple-100 text-purple-800",children:"\uD83D\uDCF1 Mobile"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-medium",children:"Available Biometrics:"}),(0,r.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:e.biometricTypes.length>0?(e=>{let t={face:"\uD83D\uDC64 Face ID",fingerprint:"\uD83D\uDC46 Touch ID / Fingerprint",voice:"\uD83D\uDDE3️ Voice Recognition",unknown:"\uD83D\uDD12 Platform Authenticator"};return e.map(e=>t[e]||e).join(", ")})(e.biometricTypes):"None detected"})]})]})]}),!e.isSupported&&(0,r.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:(0,r.jsxs)("p",{className:"text-red-800",children:[(0,r.jsx)("strong",{children:"WebAuthn not supported:"})," Your browser doesn't support WebAuthn. Please try using a modern browser like Chrome, Firefox, Safari, or Edge."]})}),e.isSupported&&!e.isPlatformAuthenticatorAvailable&&(0,r.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:(0,r.jsxs)("p",{className:"text-yellow-800",children:[(0,r.jsx)("strong",{children:"No biometric hardware detected:"})," Your device doesn't appear to have Face ID, Touch ID, or Windows Hello available."]})})]}):(0,r.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),(0,r.jsx)("span",{className:"ml-2",children:"Checking capabilities..."})]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[(0,r.jsx)("h2",{className:"text-2xl font-semibold text-gray-900 mb-6 flex items-center",children:"\uD83D\uDE80 Biometric Actions"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(n.z,{onClick:N,disabled:!(null==e?void 0:e.isPlatformAuthenticatorAvailable)||i,className:"w-full h-16 text-lg font-semibold bg-blue-600 hover:bg-blue-700 disabled:bg-gray-300",children:"registering"===m?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),"Registering Biometric..."]}):(0,r.jsx)(r.Fragment,{children:"\uD83D\uDD10 Register Face ID/Touch ID"})}),"idle"!==m&&(0,r.jsxs)("div",{className:"text-sm px-3 py-1 rounded-full text-white text-center ".concat(k(m)),children:["registering"===m&&"Follow your device prompt...","success"===m&&"Registration successful! ✅","error"===m&&"Registration failed ❌"]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(n.z,{onClick:A,disabled:!(null==e?void 0:e.isPlatformAuthenticatorAvailable)||i||0===u.length,className:"w-full h-16 text-lg font-semibold bg-green-600 hover:bg-green-700 disabled:bg-gray-300",children:"authenticating"===x?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),"Authenticating..."]}):(0,r.jsx)(r.Fragment,{children:"\uD83D\uDD13 Authenticate with Biometric"})}),"idle"!==x&&(0,r.jsxs)("div",{className:"text-sm px-3 py-1 rounded-full text-white text-center ".concat(k(x)),children:["authenticating"===x&&"Follow your device prompt...","success"===x&&"Authentication successful! ✅","error"===x&&"Authentication failed ❌"]})]})]}),0===u.length&&(0,r.jsx)("div",{className:"mt-4 bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,r.jsxs)("p",{className:"text-blue-800 text-sm",children:[(0,r.jsx)("strong",{children:"No biometric credentials registered."}),' Click "Register Face ID/Touch ID" to set up biometric authentication.']})})]}),u.length>0&&(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[(0,r.jsxs)("h2",{className:"text-2xl font-semibold text-gray-900 mb-4 flex items-center",children:["\uD83D\uDCBE Saved Credentials (",u.length,")"]}),(0,r.jsx)("div",{className:"space-y-3",children:u.map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("div",{className:"font-medium text-gray-900",children:e.friendlyName}),(0,r.jsxs)("div",{className:"text-sm text-gray-600",children:["Created: ",new Date(e.createdAt).toLocaleString()]}),(0,r.jsxs)("div",{className:"text-xs text-gray-500 font-mono",children:["ID: ",e.credentialId.substring(0,20),"..."]})]}),(0,r.jsx)(n.z,{onClick:()=>S(e.credentialId),variant:"outline",className:"text-red-600 border-red-300 hover:bg-red-50",size:"sm",children:"\uD83D\uDDD1️ Delete"})]},e.id))})]}),(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[(0,r.jsx)("h2",{className:"text-2xl font-semibold text-gray-900 mb-4 flex items-center",children:"\uD83D\uDCDA How Real Biometric Authentication Works"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-blue-600 mb-2",children:"\uD83D\uDD10 Registration Process"}),(0,r.jsxs)("ol",{className:"list-decimal list-inside space-y-1 text-sm text-gray-700",children:[(0,r.jsx)("li",{children:"Browser checks for biometric hardware availability"}),(0,r.jsx)("li",{children:"Server generates a unique cryptographic challenge"}),(0,r.jsx)("li",{children:"Your device prompts for Face ID/Touch ID/Windows Hello"}),(0,r.jsx)("li",{children:"Secure enclave creates a public-private key pair"}),(0,r.jsx)("li",{children:"Public key is sent to server (biometric data never leaves device)"}),(0,r.jsx)("li",{children:"Credential is stored for future authentication"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-green-600 mb-2",children:"\uD83D\uDD13 Authentication Process"}),(0,r.jsxs)("ol",{className:"list-decimal list-inside space-y-1 text-sm text-gray-700",children:[(0,r.jsx)("li",{children:"Server sends authentication challenge"}),(0,r.jsx)("li",{children:"Browser requests biometric verification"}),(0,r.jsx)("li",{children:"You authenticate with Face ID/Touch ID/Windows Hello"}),(0,r.jsx)("li",{children:"Device signs the challenge with your private key"}),(0,r.jsx)("li",{children:"Server verifies the signature using your public key"}),(0,r.jsx)("li",{children:"Access granted if signature is valid"})]})]})]}),(0,r.jsxs)("div",{className:"mt-6 bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,r.jsx)("h4",{className:"font-semibold text-blue-800 mb-2",children:"\uD83D\uDD12 Security Features"}),(0,r.jsxs)("ul",{className:"text-sm text-blue-700 space-y-1",children:[(0,r.jsxs)("li",{children:["• ",(0,r.jsx)("strong",{children:"Privacy:"})," Your biometric data never leaves your device"]}),(0,r.jsxs)("li",{children:["• ",(0,r.jsx)("strong",{children:"Phishing Resistant:"})," Credentials are bound to specific domains"]}),(0,r.jsxs)("li",{children:["• ",(0,r.jsx)("strong",{children:"Replay Protection:"})," Each authentication uses a unique challenge"]}),(0,r.jsxs)("li",{children:["• ",(0,r.jsx)("strong",{children:"Device Security:"})," Keys are stored in secure hardware (Secure Enclave/TEE)"]}),(0,r.jsxs)("li",{children:["• ",(0,r.jsx)("strong",{children:"No Passwords:"})," Eliminates password-related vulnerabilities"]})]})]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsx)("h2",{className:"text-2xl font-semibold text-gray-900 flex items-center",children:"\uD83D\uDCCA Real-time Logs"}),(0,r.jsx)(n.z,{onClick:()=>{d([]),y("info","Logs cleared")},variant:"outline",size:"sm",className:"text-gray-600",children:"\uD83E\uDDF9 Clear Logs"})]}),(0,r.jsx)("div",{className:"bg-gray-900 rounded-lg p-4 h-64 overflow-y-auto",children:0===c.length?(0,r.jsx)("p",{className:"text-gray-400 text-center",children:"No logs yet. Interact with the buttons above to see real-time updates."}):(0,r.jsx)("div",{className:"space-y-1",children:c.map((e,t)=>(0,r.jsxs)("div",{className:"text-sm font-mono",children:[(0,r.jsx)("span",{className:"text-gray-400",children:new Date(e.timestamp).toLocaleTimeString()})," ",(0,r.jsxs)("span",{className:"error"===e.type?"text-red-400":"success"===e.type?"text-green-400":"warning"===e.type?"text-yellow-400":"text-blue-400",children:["[",e.type.toUpperCase(),"]"]})," ",(0,r.jsx)("span",{className:"text-gray-100",children:e.message})]},t))})})]}),(0,r.jsx)("div",{className:"text-center py-4 text-gray-600",children:(0,r.jsxs)("p",{className:"text-sm",children:["This demo uses the ",(0,r.jsx)("strong",{children:"WebAuthn API"})," with real biometric hardware on your device.",(0,r.jsx)("br",{}),"Supported on iOS (Face ID/Touch ID), Android (Biometric), macOS (Touch ID), and Windows (Hello)."]})})]})})}}},function(e){e.O(0,[216,592,478,560],function(){return e(e.s=32020)}),_N_E=e.O()}]);