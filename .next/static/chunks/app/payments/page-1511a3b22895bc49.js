(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3074],{22209:function(e,t,a){Promise.resolve().then(a.bind(a,2962))},92513:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(78030).Z)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},29338:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(78030).Z)("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]])},10883:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(78030).Z)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]])},2962:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return y}});var r=a(57437),s=a(2265),l=a(21513),d=a(78030);let c=(0,d.Z)("bitcoin",[["path",{d:"M11.767 19.089c4.924.868 6.14-6.025 1.216-6.894m-1.216 6.894L5.86 18.047m5.908 1.042-.347 1.97m1.563-8.864c4.924.869 6.14-6.025 1.215-6.893m-1.215 6.893-3.94-.694m5.155-6.2L8.29 4.26m5.908 1.042.348-1.97M7.48 20.364l3.126-17.727",key:"yr8idg"}]]),i=(0,d.Z)("wallet",[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]]);var n=a(56935),o=a(92513),m=a(29338),p=a(10883),x=a(74697),u=a(31313),h=a(89733);function y(){let[e,t]=(0,s.useState)([]),[a,d]=(0,s.useState)(!0),[y,b]=(0,s.useState)(!1),[f,g]=(0,s.useState)(!1),[v,j]=(0,s.useState)({type:"card",provider:"stripe",isDefault:!1}),[N,w]=(0,s.useState)({});(0,s.useEffect)(()=>{k()},[]);let k=async()=>{try{let e=await fetch("/api/payments/methods");if(e.ok){let a=await e.json();t(a.data)}}catch(e){console.error("Failed to fetch payment methods:",e)}finally{d(!1)}},C=()=>{let e={};if("card"===v.type){var t;(null===(t=v.cardNumber)||void 0===t?void 0:t.replace(/\s/g,""))?/^\d{13,19}$/.test(v.cardNumber.replace(/\s/g,""))||(e.cardNumber="Please enter a valid card number"):e.cardNumber="Card number is required",v.expiryMonth||(e.expiryMonth="Expiry month is required"),v.expiryYear||(e.expiryYear="Expiry year is required"),v.cvc?/^\d{3,4}$/.test(v.cvc)||(e.cvc="Please enter a valid CVC"):e.cvc="CVC is required"}else"crypto"!==v.type||v.walletAddress||(e.walletAddress="Wallet address is required");return w(e),0===Object.keys(e).length},M=async()=>{if(C()){g(!0);try{var e;Date.now().toString(),v.type,v.provider,"card"===v.type?(null===(e=v.cardNumber)||void 0===e||e.slice(-4),parseInt(v.expiryMonth||"0"),parseInt(v.expiryYear||"0")):(v.walletAddress,v.network),v.isDefault,(await fetch("/api/payments/methods",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:v.type,provider:v.provider,..."crypto"===v.type&&{walletAddress:v.walletAddress,network:v.network},isDefault:v.isDefault})})).ok&&(await k(),b(!1),j({type:"card",provider:"stripe",isDefault:!1}),w({}))}catch(e){console.error("Failed to add payment method:",e)}finally{g(!1)}}},A=async e=>{try{(await fetch("/api/payments/methods/".concat(e),{method:"DELETE"})).ok&&t(t=>t.filter(t=>t.id!==e))}catch(e){console.error("Failed to remove payment method:",e)}},D=async e=>{try{(await fetch("/api/payments/methods/".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({isDefault:!0})})).ok&&await k()}catch(e){console.error("Failed to set default payment method:",e)}},Z=e=>{let t=e.replace(/\s+/g,"").replace(/[^0-9]/gi,""),a=t.match(/\d{4,16}/g),r=a&&a[0]||"",s=[];for(let e=0,t=r.length;e<t;e+=4)s.push(r.substring(e,e+4));return s.length?s.join(" "):t},S=e=>"crypto"===e.type?"bitcoin"===e.provider?c:i:n.Z,E=e=>{var t,a,r;if("crypto"===e.type){let r=e.details;return"".concat(e.provider.charAt(0).toUpperCase()+e.provider.slice(1)," Wallet (").concat(null===(t=r.walletAddress)||void 0===t?void 0:t.slice(0,6),"...").concat(null===(a=r.walletAddress)||void 0===a?void 0:a.slice(-4),")")}{let t=e.details;return"".concat(null===(r=t.brand)||void 0===r?void 0:r.toUpperCase()," •••• ").concat(t.last4)}};return a?(0,r.jsx)(u.Z,{activeTab:"payments",children:(0,r.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})})}):(0,r.jsx)(u.Z,{activeTab:"payments",children:(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Payment Methods"}),(0,r.jsx)("p",{className:"text-gray-600 mt-1",children:"Manage your cards and crypto wallets"})]}),(0,r.jsxs)(h.z,{onClick:()=>b(!0),className:"flex items-center space-x-2",children:[(0,r.jsx)(o.Z,{className:"w-4 h-4"}),(0,r.jsx)("span",{children:"Add Payment Method"})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8",children:[e.map((e,t)=>{var a;let s=S(e);return(0,r.jsxs)(l.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*t},className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 relative",children:[e.isDefault&&(0,r.jsx)("div",{className:"absolute top-4 right-4",children:(0,r.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[(0,r.jsx)(m.Z,{className:"w-3 h-3 mr-1"}),"Default"]})}),(0,r.jsxs)("div",{className:"flex items-center space-x-4 mb-4",children:[(0,r.jsx)("div",{className:"p-3 rounded-full ".concat("crypto"===e.type?"bg-orange-100":"bg-blue-100"),children:(0,r.jsx)(s,{className:"w-6 h-6 ".concat("crypto"===e.type?"text-orange-600":"text-blue-600")})}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("p",{className:"font-semibold text-gray-900",children:E(e)}),(0,r.jsxs)("p",{className:"text-sm text-gray-500 capitalize",children:[e.type," • ",e.provider]})]})]}),"card"===e.type&&(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["Expires ",null===(a=e.details.expMonth)||void 0===a?void 0:a.toString().padStart(2,"0"),"/",e.details.expYear]})}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("div",{className:"flex space-x-2",children:!e.isDefault&&(0,r.jsx)(h.z,{size:"sm",variant:"outline",onClick:()=>D(e.id),className:"text-xs",children:"Set Default"})}),(0,r.jsx)("button",{onClick:()=>A(e.id),className:"p-1 text-gray-400 hover:text-red-600 transition-colors",children:(0,r.jsx)(p.Z,{className:"w-4 h-4"})})]})]},e.id)}),0===e.length&&(0,r.jsxs)("div",{className:"col-span-full text-center py-12",children:[(0,r.jsx)(n.Z,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),(0,r.jsx)("p",{className:"text-gray-500",children:"No payment methods added"}),(0,r.jsx)("p",{className:"text-sm text-gray-400 mt-1",children:"Add a card or crypto wallet to get started"})]})]}),y&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,r.jsx)(l.E.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"bg-white rounded-lg shadow-xl max-w-md w-full max-h-[90vh] overflow-y-auto",children:(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"Add Payment Method"}),(0,r.jsx)("button",{onClick:()=>b(!1),className:"text-gray-400 hover:text-gray-600",children:(0,r.jsx)(x.Z,{className:"w-5 h-5"})})]}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Payment Type"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,r.jsxs)("button",{type:"button",onClick:()=>j(e=>({...e,type:"card",provider:"stripe"})),className:"p-4 border rounded-lg flex items-center space-x-3 ".concat("card"===v.type?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-300 hover:border-gray-400"),children:[(0,r.jsx)(n.Z,{className:"w-5 h-5"}),(0,r.jsx)("span",{className:"font-medium",children:"Card"})]}),(0,r.jsxs)("button",{type:"button",onClick:()=>j(e=>({...e,type:"crypto",provider:"ethereum"})),className:"p-4 border rounded-lg flex items-center space-x-3 ".concat("crypto"===v.type?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-300 hover:border-gray-400"),children:[(0,r.jsx)(i,{className:"w-5 h-5"}),(0,r.jsx)("span",{className:"font-medium",children:"Crypto"})]})]})]}),"card"===v.type&&(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Card Number"}),(0,r.jsx)("input",{type:"text",value:v.cardNumber||"",onChange:e=>{let t=Z(e.target.value);j(e=>({...e,cardNumber:t}))},placeholder:"1234 5678 9012 3456",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent ".concat(N.cardNumber?"border-red-300":"border-gray-300"),maxLength:19}),N.cardNumber&&(0,r.jsx)("p",{className:"mt-1 text-sm text-red-600",children:N.cardNumber})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Expiry Month"}),(0,r.jsxs)("select",{value:v.expiryMonth||"",onChange:e=>j(t=>({...t,expiryMonth:e.target.value})),className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent ".concat(N.expiryMonth?"border-red-300":"border-gray-300"),children:[(0,r.jsx)("option",{value:"",children:"Month"}),Array.from({length:12},(e,t)=>t+1).map(e=>(0,r.jsx)("option",{value:e,children:e.toString().padStart(2,"0")},e))]}),N.expiryMonth&&(0,r.jsx)("p",{className:"mt-1 text-sm text-red-600",children:N.expiryMonth})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Expiry Year"}),(0,r.jsxs)("select",{value:v.expiryYear||"",onChange:e=>j(t=>({...t,expiryYear:e.target.value})),className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent ".concat(N.expiryYear?"border-red-300":"border-gray-300"),children:[(0,r.jsx)("option",{value:"",children:"Year"}),Array.from({length:10},(e,t)=>new Date().getFullYear()+t).map(e=>(0,r.jsx)("option",{value:e,children:e},e))]}),N.expiryYear&&(0,r.jsx)("p",{className:"mt-1 text-sm text-red-600",children:N.expiryYear})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"CVC"}),(0,r.jsx)("input",{type:"text",value:v.cvc||"",onChange:e=>{let t=e.target.value.replace(/\D/g,"");j(e=>({...e,cvc:t}))},placeholder:"123",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent ".concat(N.cvc?"border-red-300":"border-gray-300"),maxLength:4}),N.cvc&&(0,r.jsx)("p",{className:"mt-1 text-sm text-red-600",children:N.cvc})]})]}),"crypto"===v.type&&(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Network"}),(0,r.jsxs)("select",{value:v.provider,onChange:e=>j(t=>({...t,provider:e.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,r.jsx)("option",{value:"ethereum",children:"Ethereum"}),(0,r.jsx)("option",{value:"bitcoin",children:"Bitcoin"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Wallet Address"}),(0,r.jsx)("input",{type:"text",value:v.walletAddress||"",onChange:e=>j(t=>({...t,walletAddress:e.target.value})),placeholder:"ethereum"===v.provider?"0x...":"1...",className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent ".concat(N.walletAddress?"border-red-300":"border-gray-300")}),N.walletAddress&&(0,r.jsx)("p",{className:"mt-1 text-sm text-red-600",children:N.walletAddress})]})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"checkbox",id:"isDefault",checked:v.isDefault,onChange:e=>j(t=>({...t,isDefault:e.target.checked})),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,r.jsx)("label",{htmlFor:"isDefault",className:"ml-2 text-sm text-gray-900",children:"Set as default payment method"})]}),(0,r.jsxs)("div",{className:"flex space-x-3 pt-4",children:[(0,r.jsx)(h.z,{onClick:M,disabled:f,className:"flex-1",children:f?(0,r.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):"Add Payment Method"}),(0,r.jsx)(h.z,{variant:"outline",onClick:()=>b(!1),className:"flex-1",children:"Cancel"})]})]})]})})})]})})}}},function(e){e.O(0,[4868,2557,6368,5900,1313,2971,7023,1744],function(){return e(e.s=22209)}),_N_E=e.O()}]);