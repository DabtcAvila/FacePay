(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[74],{22209:function(e,t,a){Promise.resolve().then(a.bind(a,27943))},27943:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return y}});var s=a(57437),r=a(2265),l=a(48506),i=a(33730),c=a(56935),d=a(92513),n=a(36141),o=a(29338),m=a(10883),x=a(95737),p=a(74697),h=a(55179),u=a(50362);function y(){let[e,t]=(0,r.useState)([]),[a,y]=(0,r.useState)(!0),[b,v]=(0,r.useState)(!1),[f,j]=(0,r.useState)(!1),[g,N]=(0,r.useState)({type:"card",provider:"stripe",isDefault:!1}),[w,k]=(0,r.useState)({});(0,r.useEffect)(()=>{C()},[]);let C=async()=>{try{let e=await fetch("/api/payments/methods");if(e.ok){let a=await e.json();t(a.data)}}catch(e){console.error("Failed to fetch payment methods:",e)}finally{y(!1)}},A=()=>{let e={};if("card"===g.type){var t;(null===(t=g.cardNumber)||void 0===t?void 0:t.replace(/\s/g,""))?/^\d{13,19}$/.test(g.cardNumber.replace(/\s/g,""))||(e.cardNumber="Please enter a valid card number"):e.cardNumber="Card number is required",g.expiryMonth||(e.expiryMonth="Expiry month is required"),g.expiryYear||(e.expiryYear="Expiry year is required"),g.cvc?/^\d{3,4}$/.test(g.cvc)||(e.cvc="Please enter a valid CVC"):e.cvc="CVC is required"}else"crypto"!==g.type||g.walletAddress||(e.walletAddress="Wallet address is required");return k(e),0===Object.keys(e).length},E=async()=>{if(A()){j(!0);try{var e;Date.now().toString(),g.type,g.provider,"card"===g.type?(null===(e=g.cardNumber)||void 0===e||e.slice(-4),parseInt(g.expiryMonth||"0"),parseInt(g.expiryYear||"0")):(g.walletAddress,g.network),g.isDefault,(await fetch("/api/payments/methods",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:g.type,provider:g.provider,..."crypto"===g.type&&{walletAddress:g.walletAddress,network:g.network},isDefault:g.isDefault})})).ok&&(await C(),v(!1),N({type:"card",provider:"stripe",isDefault:!1}),k({}))}catch(e){console.error("Failed to add payment method:",e)}finally{j(!1)}}},D=async e=>{try{(await fetch("/api/payments/methods/".concat(e),{method:"DELETE"})).ok&&t(t=>t.filter(t=>t.id!==e))}catch(e){console.error("Failed to remove payment method:",e)}},M=async e=>{try{(await fetch("/api/payments/methods/".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({isDefault:!0})})).ok&&await C()}catch(e){console.error("Failed to set default payment method:",e)}},S=e=>{let t=e.replace(/\s+/g,"").replace(/[^0-9]/gi,""),a=t.match(/\d{4,16}/g),s=a&&a[0]||"",r=[];for(let e=0,t=s.length;e<t;e+=4)r.push(s.substring(e,e+4));return r.length?r.join(" "):t},Z=e=>"crypto"===e.type?"bitcoin"===e.provider?i.Z:x.Z:c.Z,T=e=>{var t,a,s;if("crypto"===e.type){let s=e.details;return"".concat(e.provider.charAt(0).toUpperCase()+e.provider.slice(1)," Wallet (").concat(null===(t=s.walletAddress)||void 0===t?void 0:t.slice(0,6),"...").concat(null===(a=s.walletAddress)||void 0===a?void 0:a.slice(-4),")")}{let t=e.details;return"".concat(null===(s=t.brand)||void 0===s?void 0:s.toUpperCase()," •••• ").concat(t.last4)}};return a?(0,s.jsx)(h.Z,{activeTab:"payments",children:(0,s.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})})}):(0,s.jsx)(h.Z,{activeTab:"payments",children:(0,s.jsxs)("div",{className:"p-4 sm:p-6 lg:p-8",children:[(0,s.jsxs)(l.EA.div,{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between space-y-4 sm:space-y-0 mb-8",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl sm:text-3xl lg:text-4xl font-bold text-gray-900",children:"Payment Methods"}),(0,s.jsx)("p",{className:"text-gray-600 mt-2 text-base sm:text-lg",children:"Manage your cards, wallets, and crypto accounts"})]}),(0,s.jsx)(l.EA.div,{whileHover:{scale:1.02},whileTap:{scale:.98},children:(0,s.jsxs)(u.z,{onClick:()=>v(!0),className:"btn-primary px-6 py-3 shadow-xl w-full sm:w-auto",children:[(0,s.jsx)(d.Z,{className:"w-5 h-5 mr-3"}),(0,s.jsx)("span",{children:"Add Payment Method"})]})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6 mb-8",children:[e.map((e,t)=>{var a;let r=Z(e);return(0,s.jsxs)(l.EA.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*t},className:"card-premium p-6 hover-lift group relative overflow-hidden",children:[e.isDefault&&(0,s.jsx)("div",{className:"absolute top-4 right-4",children:(0,s.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[(0,s.jsx)(o.Z,{className:"w-3 h-3 mr-1"}),"Default"]})}),(0,s.jsxs)("div",{className:"flex items-center space-x-4 mb-4",children:[(0,s.jsx)("div",{className:"p-3 rounded-full ".concat("crypto"===e.type?"bg-orange-100":"bg-blue-100"),children:(0,s.jsx)(r,{className:"w-6 h-6 ".concat("crypto"===e.type?"text-orange-600":"text-blue-600")})}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"font-semibold text-gray-900",children:T(e)}),(0,s.jsxs)("p",{className:"text-sm text-gray-500 capitalize",children:[e.type," • ",e.provider]})]})]}),"card"===e.type&&(0,s.jsx)("div",{className:"mb-4",children:(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:["Expires ",null===(a=e.details.expMonth)||void 0===a?void 0:a.toString().padStart(2,"0"),"/",e.details.expYear]})}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("div",{className:"flex space-x-2",children:!e.isDefault&&(0,s.jsx)(u.z,{size:"sm",variant:"outline",onClick:()=>M(e.id),className:"text-xs",children:"Set Default"})}),(0,s.jsx)("button",{onClick:()=>D(e.id),className:"p-1 text-gray-400 hover:text-red-600 transition-colors",children:(0,s.jsx)(m.Z,{className:"w-4 h-4"})})]})]},e.id)}),0===e.length&&(0,s.jsx)(l.EA.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.6},className:"col-span-full text-center py-16",children:(0,s.jsxs)("div",{className:"max-w-md mx-auto",children:[(0,s.jsx)("div",{className:"w-24 h-24 bg-gradient-to-br from-blue-100 to-purple-100 rounded-2xl flex items-center justify-center mx-auto mb-6",children:(0,s.jsx)(c.Z,{className:"w-12 h-12 text-blue-600"})}),(0,s.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-3",children:"No Payment Methods"}),(0,s.jsx)("p",{className:"text-gray-500 mb-6 text-base leading-relaxed",children:"Add your first payment method to start making secure transactions with FacePay"}),(0,s.jsx)(l.EA.div,{whileHover:{scale:1.02},whileTap:{scale:.98},children:(0,s.jsxs)(u.z,{onClick:()=>v(!0),className:"btn-primary px-8 py-3 shadow-lg",children:[(0,s.jsx)(d.Z,{className:"w-5 h-5 mr-3"}),"Add Your First Method"]})})]})})]}),b&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,s.jsx)(l.EA.div,{initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},className:"card-premium max-w-lg w-full max-h-[90vh] overflow-y-auto shadow-2xl",children:(0,s.jsxs)("div",{className:"p-6 sm:p-8",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Add Payment Method"}),(0,s.jsx)("p",{className:"text-gray-600 text-sm mt-1",children:"Securely connect your preferred payment option"})]}),(0,s.jsx)(l.EA.button,{onClick:()=>v(!1),className:"text-gray-400 hover:text-gray-600 p-2 rounded-full hover:bg-gray-100 transition-colors",whileHover:{scale:1.1},whileTap:{scale:.9},children:(0,s.jsx)(p.Z,{className:"w-6 h-6"})})]}),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Payment Type"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,s.jsxs)("button",{type:"button",onClick:()=>N(e=>({...e,type:"card",provider:"stripe"})),className:"p-4 border rounded-lg flex items-center space-x-3 ".concat("card"===g.type?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-300 hover:border-gray-400"),children:[(0,s.jsx)(c.Z,{className:"w-5 h-5"}),(0,s.jsx)("span",{className:"font-medium",children:"Card"})]}),(0,s.jsxs)("button",{type:"button",onClick:()=>N(e=>({...e,type:"crypto",provider:"ethereum"})),className:"p-4 border rounded-lg flex items-center space-x-3 ".concat("crypto"===g.type?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-300 hover:border-gray-400"),children:[(0,s.jsx)(x.Z,{className:"w-5 h-5"}),(0,s.jsx)("span",{className:"font-medium",children:"Crypto"})]})]})]}),"card"===g.type&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Card Number"}),(0,s.jsx)("input",{type:"text",value:g.cardNumber||"",onChange:e=>{let t=S(e.target.value);N(e=>({...e,cardNumber:t}))},placeholder:"1234 5678 9012 3456",className:"form-input ".concat(w.cardNumber?"form-input-error":""),maxLength:19}),w.cardNumber&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:w.cardNumber})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Expiry Month"}),(0,s.jsxs)("select",{value:g.expiryMonth||"",onChange:e=>N(t=>({...t,expiryMonth:e.target.value})),className:"form-input ".concat(w.expiryMonth?"form-input-error":""),children:[(0,s.jsx)("option",{value:"",children:"Month"}),Array.from({length:12},(e,t)=>t+1).map(e=>(0,s.jsx)("option",{value:e,children:e.toString().padStart(2,"0")},e))]}),w.expiryMonth&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:w.expiryMonth})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Expiry Year"}),(0,s.jsxs)("select",{value:g.expiryYear||"",onChange:e=>N(t=>({...t,expiryYear:e.target.value})),className:"form-input ".concat(w.expiryYear?"form-input-error":""),children:[(0,s.jsx)("option",{value:"",children:"Year"}),Array.from({length:10},(e,t)=>new Date().getFullYear()+t).map(e=>(0,s.jsx)("option",{value:e,children:e},e))]}),w.expiryYear&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:w.expiryYear})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"CVC"}),(0,s.jsx)("input",{type:"text",value:g.cvc||"",onChange:e=>{let t=e.target.value.replace(/\D/g,"");N(e=>({...e,cvc:t}))},placeholder:"123",className:"form-input ".concat(w.cvc?"form-input-error":""),maxLength:4}),w.cvc&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:w.cvc})]})]}),"crypto"===g.type&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Network"}),(0,s.jsxs)("select",{value:g.provider,onChange:e=>N(t=>({...t,provider:e.target.value})),className:"form-input",children:[(0,s.jsx)("option",{value:"ethereum",children:"Ethereum"}),(0,s.jsx)("option",{value:"bitcoin",children:"Bitcoin"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Wallet Address"}),(0,s.jsx)("input",{type:"text",value:g.walletAddress||"",onChange:e=>N(t=>({...t,walletAddress:e.target.value})),placeholder:"ethereum"===g.provider?"0x...":"1...",className:"form-input ".concat(w.walletAddress?"form-input-error":"")}),w.walletAddress&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:w.walletAddress})]})]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"checkbox",id:"isDefault",checked:g.isDefault,onChange:e=>N(t=>({...t,isDefault:e.target.checked})),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,s.jsx)("label",{htmlFor:"isDefault",className:"ml-2 text-sm text-gray-900",children:"Set as default payment method"})]}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 pt-6",children:[(0,s.jsx)(l.EA.div,{className:"flex-1",whileHover:{scale:1.02},whileTap:{scale:.98},children:(0,s.jsx)(u.z,{onClick:E,disabled:f,className:"btn-primary w-full py-4 text-lg shadow-xl disabled:opacity-50 disabled:cursor-not-allowed",children:f?(0,s.jsxs)("div",{className:"flex items-center justify-center space-x-3",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),(0,s.jsx)("span",{children:"Adding..."})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.Z,{className:"w-5 h-5 mr-3"}),"Add Payment Method"]})})}),(0,s.jsx)(l.EA.div,{className:"flex-1",whileHover:{scale:1.02},whileTap:{scale:.98},children:(0,s.jsx)(u.z,{variant:"outline",onClick:()=>v(!1),className:"w-full py-4 text-lg border-2 border-gray-300 hover:border-blue-500 hover:bg-blue-50",children:"Cancel"})})]})]})]})})})]})})}}},function(e){e.O(0,[216,592,478,560],function(){return e(e.s=22209)}),_N_E=e.O()}]);