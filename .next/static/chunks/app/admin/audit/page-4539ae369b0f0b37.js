(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[708],{28813:function(e,a,s){Promise.resolve().then(s.bind(s,29173))},29173:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return k}});var r=s(57437),t=s(2265),i=s(12020),l=s(97730),d=s(42765),n=s(60899),o=s(36127),c=s(92940),u=s(64590),g=s(40933),x=s(97589),m=s(75733),h=s(65607),y=s(24258),p=s(36141),b=s(52022);let v=[{id:"audit_001",timestamp:"2024-01-20T14:30:00Z",userId:"admin_001",userName:"Admin Usuario",action:"UPDATE_USER",resource:"user",resourceId:"user_123",ipAddress:"192.168.1.100",userAgent:"Mozilla/5.0 Chrome/120.0.0.0",status:"success",details:"Usuario bloqueado por actividad sospechosa",changes:[{field:"status",oldValue:"active",newValue:"blocked"},{field:"blocked_reason",oldValue:"",newValue:"suspicious_activity"}],sessionId:"sess_abc123",location:"Madrid, ES"},{id:"audit_002",timestamp:"2024-01-20T13:15:00Z",userId:"admin_002",userName:"Maria Garc\xeda",action:"DELETE_TRANSACTION",resource:"transaction",resourceId:"tx_456",ipAddress:"203.0.113.45",userAgent:"Mozilla/5.0 Safari/17.0",status:"success",details:"Transacci\xf3n eliminada por solicitud de reembolso",changes:[{field:"status",oldValue:"completed",newValue:"deleted"},{field:"reason",oldValue:"",newValue:"refund_request"}],sessionId:"sess_def456",location:"Barcelona, ES"},{id:"audit_003",timestamp:"2024-01-20T12:45:00Z",userId:"admin_001",userName:"Admin Usuario",action:"LOGIN_ATTEMPT",resource:"auth",ipAddress:"198.51.100.23",userAgent:"Mozilla/5.0 Firefox/121.0",status:"failure",details:"Intento de login fallido - contrase\xf1a incorrecta",sessionId:"sess_ghi789",location:"Valencia, ES"},{id:"audit_004",timestamp:"2024-01-20T11:20:00Z",userId:"admin_003",userName:"Carlos L\xf3pez",action:"UPDATE_SETTINGS",resource:"system_settings",resourceId:"security_config",ipAddress:"203.0.113.66",userAgent:"Mozilla/5.0 Chrome/120.0.0.0",status:"warning",details:"Configuraci\xf3n de seguridad modificada",changes:[{field:"max_login_attempts",oldValue:"5",newValue:"3"},{field:"session_timeout",oldValue:"30",newValue:"15"}],sessionId:"sess_jkl012",location:"Sevilla, ES"},{id:"audit_005",timestamp:"2024-01-20T10:05:00Z",userId:"admin_002",userName:"Maria Garc\xeda",action:"VIEW_USER_DATA",resource:"user",resourceId:"user_789",ipAddress:"192.0.2.150",userAgent:"Mozilla/5.0 Chrome/120.0.0.0",status:"success",details:"Consulta de datos de usuario para investigaci\xf3n de seguridad",sessionId:"sess_mno345",location:"Madrid, ES"}],j=[{name:"00:00",value:5},{name:"04:00",value:2},{name:"08:00",value:15},{name:"12:00",value:28},{name:"16:00",value:34},{name:"20:00",value:19}],N=e=>{let{status:a}=e,{color:s,icon:t}=(()=>{switch(a){case"success":return{color:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",icon:c.Z};case"failure":return{color:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",icon:o.Z};case"warning":return{color:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200",icon:o.Z};default:return{color:"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200",icon:g.Z}}})();return(0,r.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(s),children:[(0,r.jsx)(t,{className:"w-3 h-3 mr-1"}),{success:"\xc9xito",failure:"Fallo",warning:"Advertencia"}[a]||"Desconocido"]})},f=e=>{let{action:a}=e,{color:s,icon:t}={LOGIN_ATTEMPT:{color:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",icon:p.Z},UPDATE_USER:{color:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200",icon:b.Z},DELETE_TRANSACTION:{color:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",icon:x.Z},UPDATE_SETTINGS:{color:"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200",icon:y.Z},VIEW_USER_DATA:{color:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",icon:m.Z}}[a]||{color:"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200",icon:u.Z};return(0,r.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(s),children:[(0,r.jsx)(t,{className:"w-3 h-3 mr-1"}),a.replace(/_/g," ").toLowerCase()]})};function k(){let[e]=(0,t.useState)(v),[a,s]=(0,t.useState)("24h"),g=[{accessorKey:"timestamp",header:"Fecha y Hora",cell:e=>{let{row:a}=e,s=new Date(a.original.timestamp);return(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"font-medium text-gray-900 dark:text-white text-sm",children:s.toLocaleDateString("es-ES")}),(0,r.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:s.toLocaleTimeString("es-ES")})]})}},{accessorKey:"userName",header:"Usuario",cell:e=>{let{row:a}=e;return(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"font-medium text-gray-900 dark:text-white",children:a.original.userName}),(0,r.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:a.original.userId})]})}},{accessorKey:"action",header:"Acci\xf3n",cell:e=>{let{row:a}=e;return(0,r.jsx)(f,{action:a.original.action})}},{accessorKey:"resource",header:"Recurso",cell:e=>{let{row:a}=e;return(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"font-medium text-gray-900 dark:text-white",children:a.original.resource}),a.original.resourceId&&(0,r.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400 font-mono",children:a.original.resourceId})]})}},{accessorKey:"status",header:"Estado",cell:e=>{let{row:a}=e;return(0,r.jsx)(N,{status:a.original.status})}},{accessorKey:"details",header:"Detalles",cell:e=>{let{row:a}=e;return(0,r.jsx)("div",{className:"max-w-xs truncate",title:a.original.details,children:a.original.details})}},{accessorKey:"ipAddress",header:"IP / Ubicaci\xf3n",cell:e=>{let{row:a}=e;return(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"font-mono text-sm text-gray-900 dark:text-white",children:a.original.ipAddress}),(0,r.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:a.original.location})]})}}],x=e.length,m=e.filter(e=>"success"===e.status).length,y=e.filter(e=>"failure"===e.status).length,p=e.filter(e=>"warning"===e.status).length;return(0,r.jsx)(i.Z,{title:"Logs de Auditor\xeda",description:"Registro completo de todas las acciones administrativas",children:(0,r.jsxs)("div",{className:"p-6 space-y-6",children:[(0,r.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-4",children:(0,r.jsx)("div",{className:"flex items-center justify-between",children:(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)(h.Z,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"}),(0,r.jsx)("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Rango de tiempo:"}),(0,r.jsxs)("select",{value:a,onChange:e=>s(e.target.value),className:"border border-gray-300 dark:border-gray-600 rounded-md px-3 py-2 text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[(0,r.jsx)("option",{value:"1h",children:"\xdaltima hora"}),(0,r.jsx)("option",{value:"24h",children:"\xdaltimas 24 horas"}),(0,r.jsx)("option",{value:"7d",children:"\xdaltimos 7 d\xedas"}),(0,r.jsx)("option",{value:"30d",children:"\xdaltimos 30 d\xedas"}),(0,r.jsx)("option",{value:"90d",children:"\xdaltimos 90 d\xedas"})]})]})})}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,r.jsx)(d.Z,{title:"Total de Acciones",value:x.toString(),change:"\xdaltimas 24h",changeType:"neutral",icon:u.Z,variant:"users"}),(0,r.jsx)(d.Z,{title:"Exitosas",value:m.toString(),change:"".concat((m/x*100).toFixed(1),"% del total"),changeType:"positive",icon:c.Z,variant:"success"}),(0,r.jsx)(d.Z,{title:"Fallidas",value:y.toString(),change:y>0?"Revisar causas":"Todo OK",changeType:y>0?"negative":"positive",icon:o.Z,variant:"error"}),(0,r.jsx)(d.Z,{title:"Advertencias",value:p.toString(),change:"Acciones sensibles",changeType:"neutral",icon:o.Z,variant:"warning"})]}),(0,r.jsx)(n.Z,{data:j,title:"Actividad de Auditor\xeda por Hora",color:"#8B5CF6",height:300}),p>0&&(0,r.jsx)("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-4",children:(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)(o.Z,{className:"w-5 h-5 text-yellow-600 dark:text-yellow-400 mt-0.5 mr-3"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-yellow-800 dark:text-yellow-200",children:"Acciones Cr\xedticas Detectadas"}),(0,r.jsxs)("p",{className:"text-sm text-yellow-700 dark:text-yellow-300 mt-1",children:["Se han detectado ",p," acciones que requieren revisi\xf3n. Estas incluyen cambios en configuraciones cr\xedticas de seguridad."]})]})]})}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[(0,r.jsx)("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700",children:(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Acciones M\xe1s Frecuentes"})}),(0,r.jsx)("div",{className:"p-6",children:(0,r.jsx)("div",{className:"space-y-4",children:["UPDATE_USER","VIEW_USER_DATA","LOGIN_ATTEMPT","UPDATE_SETTINGS"].map((a,s)=>{let t=e.filter(e=>e.action===a).length;return(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("div",{className:"flex items-center space-x-2",children:(0,r.jsx)("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:a.replace(/_/g," ")})}),(0,r.jsx)("span",{className:"text-sm font-semibold text-gray-600 dark:text-gray-400",children:t})]},a)})})})]}),(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[(0,r.jsx)("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700",children:(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Usuarios M\xe1s Activos"})}),(0,r.jsx)("div",{className:"p-6",children:(0,r.jsx)("div",{className:"space-y-4",children:["Admin Usuario","Maria Garc\xeda","Carlos L\xf3pez"].map((a,s)=>{let t=e.filter(e=>e.userName===a).length;return(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"h-8 w-8 bg-gray-300 dark:bg-gray-600 rounded-full flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-xs font-medium text-gray-700 dark:text-gray-300",children:a.split(" ").map(e=>e[0]).join("")})}),(0,r.jsx)("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:a})]}),(0,r.jsxs)("span",{className:"text-sm font-semibold text-gray-600 dark:text-gray-400",children:[t," acciones"]})]},a)})})})]})]}),(0,r.jsx)(l.Z,{data:e,columns:g,title:"Registro de Auditor\xeda",onExport:()=>{console.log("Exporting audit logs...")}})]})})}}},function(e){e.O(0,[216,592,478,560],function(){return e(e.s=28813)}),_N_E=e.O()}]);