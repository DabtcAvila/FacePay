(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3708],{28813:function(e,a,t){Promise.resolve().then(t.bind(t,52830))},40933:function(e,a,t){"use strict";t.d(a,{Z:function(){return r}});let r=(0,t(78030).Z)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]])},97589:function(e,a,t){"use strict";t.d(a,{Z:function(){return r}});let r=(0,t(78030).Z)("database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]])},36127:function(e,a,t){"use strict";t.d(a,{Z:function(){return r}});let r=(0,t(78030).Z)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},52022:function(e,a,t){"use strict";t.d(a,{Z:function(){return r}});let r=(0,t(78030).Z)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},52830:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return N}});var r=t(57437),s=t(2265),i=t(88900),l=t(79061),d=t(70292),o=t(93452),n=t(92940),c=t(36127),u=t(40933),x=t(20500),g=t(52022),m=t(97589),h=t(24258),y=t(75733),p=t(64590),b=t(65607);let k=[{id:"audit_001",timestamp:"2024-01-20T14:30:00Z",userId:"admin_001",userName:"Admin Usuario",action:"UPDATE_USER",resource:"user",resourceId:"user_123",ipAddress:"192.168.1.100",userAgent:"Mozilla/5.0 Chrome/120.0.0.0",status:"success",details:"Usuario bloqueado por actividad sospechosa",changes:[{field:"status",oldValue:"active",newValue:"blocked"},{field:"blocked_reason",oldValue:"",newValue:"suspicious_activity"}],sessionId:"sess_abc123",location:"Madrid, ES"},{id:"audit_002",timestamp:"2024-01-20T13:15:00Z",userId:"admin_002",userName:"Maria Garc\xeda",action:"DELETE_TRANSACTION",resource:"transaction",resourceId:"tx_456",ipAddress:"203.0.113.45",userAgent:"Mozilla/5.0 Safari/17.0",status:"success",details:"Transacci\xf3n eliminada por solicitud de reembolso",changes:[{field:"status",oldValue:"completed",newValue:"deleted"},{field:"reason",oldValue:"",newValue:"refund_request"}],sessionId:"sess_def456",location:"Barcelona, ES"},{id:"audit_003",timestamp:"2024-01-20T12:45:00Z",userId:"admin_001",userName:"Admin Usuario",action:"LOGIN_ATTEMPT",resource:"auth",ipAddress:"198.51.100.23",userAgent:"Mozilla/5.0 Firefox/121.0",status:"failure",details:"Intento de login fallido - contrase\xf1a incorrecta",sessionId:"sess_ghi789",location:"Valencia, ES"},{id:"audit_004",timestamp:"2024-01-20T11:20:00Z",userId:"admin_003",userName:"Carlos L\xf3pez",action:"UPDATE_SETTINGS",resource:"system_settings",resourceId:"security_config",ipAddress:"203.0.113.66",userAgent:"Mozilla/5.0 Chrome/120.0.0.0",status:"warning",details:"Configuraci\xf3n de seguridad modificada",changes:[{field:"max_login_attempts",oldValue:"5",newValue:"3"},{field:"session_timeout",oldValue:"30",newValue:"15"}],sessionId:"sess_jkl012",location:"Sevilla, ES"},{id:"audit_005",timestamp:"2024-01-20T10:05:00Z",userId:"admin_002",userName:"Maria Garc\xeda",action:"VIEW_USER_DATA",resource:"user",resourceId:"user_789",ipAddress:"192.0.2.150",userAgent:"Mozilla/5.0 Chrome/120.0.0.0",status:"success",details:"Consulta de datos de usuario para investigaci\xf3n de seguridad",sessionId:"sess_mno345",location:"Madrid, ES"}],j=[{name:"00:00",value:5},{name:"04:00",value:2},{name:"08:00",value:15},{name:"12:00",value:28},{name:"16:00",value:34},{name:"20:00",value:19}],v=e=>{let{status:a}=e,{color:t,icon:s}=(()=>{switch(a){case"success":return{color:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",icon:n.Z};case"failure":return{color:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",icon:c.Z};case"warning":return{color:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200",icon:c.Z};default:return{color:"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200",icon:u.Z}}})();return(0,r.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(t),children:[(0,r.jsx)(s,{className:"w-3 h-3 mr-1"}),{success:"\xc9xito",failure:"Fallo",warning:"Advertencia"}[a]||"Desconocido"]})},f=e=>{let{action:a}=e,{color:t,icon:s}={LOGIN_ATTEMPT:{color:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",icon:x.Z},UPDATE_USER:{color:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200",icon:g.Z},DELETE_TRANSACTION:{color:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",icon:m.Z},UPDATE_SETTINGS:{color:"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200",icon:h.Z},VIEW_USER_DATA:{color:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",icon:y.Z}}[a]||{color:"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200",icon:p.Z};return(0,r.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(t),children:[(0,r.jsx)(s,{className:"w-3 h-3 mr-1"}),a.replace(/_/g," ").toLowerCase()]})};function N(){let[e]=(0,s.useState)(k),[a,t]=(0,s.useState)("24h"),u=[{accessorKey:"timestamp",header:"Fecha y Hora",cell:e=>{let{row:a}=e,t=new Date(a.original.timestamp);return(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"font-medium text-gray-900 dark:text-white text-sm",children:t.toLocaleDateString("es-ES")}),(0,r.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:t.toLocaleTimeString("es-ES")})]})}},{accessorKey:"userName",header:"Usuario",cell:e=>{let{row:a}=e;return(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"font-medium text-gray-900 dark:text-white",children:a.original.userName}),(0,r.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:a.original.userId})]})}},{accessorKey:"action",header:"Acci\xf3n",cell:e=>{let{row:a}=e;return(0,r.jsx)(f,{action:a.original.action})}},{accessorKey:"resource",header:"Recurso",cell:e=>{let{row:a}=e;return(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"font-medium text-gray-900 dark:text-white",children:a.original.resource}),a.original.resourceId&&(0,r.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400 font-mono",children:a.original.resourceId})]})}},{accessorKey:"status",header:"Estado",cell:e=>{let{row:a}=e;return(0,r.jsx)(v,{status:a.original.status})}},{accessorKey:"details",header:"Detalles",cell:e=>{let{row:a}=e;return(0,r.jsx)("div",{className:"max-w-xs truncate",title:a.original.details,children:a.original.details})}},{accessorKey:"ipAddress",header:"IP / Ubicaci\xf3n",cell:e=>{let{row:a}=e;return(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"font-mono text-sm text-gray-900 dark:text-white",children:a.original.ipAddress}),(0,r.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:a.original.location})]})}}],x=e.length,g=e.filter(e=>"success"===e.status).length,m=e.filter(e=>"failure"===e.status).length,h=e.filter(e=>"warning"===e.status).length;return(0,r.jsx)(i.Z,{title:"Logs de Auditor\xeda",description:"Registro completo de todas las acciones administrativas",children:(0,r.jsxs)("div",{className:"p-6 space-y-6",children:[(0,r.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-4",children:(0,r.jsx)("div",{className:"flex items-center justify-between",children:(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)(b.Z,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"}),(0,r.jsx)("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Rango de tiempo:"}),(0,r.jsxs)("select",{value:a,onChange:e=>t(e.target.value),className:"border border-gray-300 dark:border-gray-600 rounded-md px-3 py-2 text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[(0,r.jsx)("option",{value:"1h",children:"\xdaltima hora"}),(0,r.jsx)("option",{value:"24h",children:"\xdaltimas 24 horas"}),(0,r.jsx)("option",{value:"7d",children:"\xdaltimos 7 d\xedas"}),(0,r.jsx)("option",{value:"30d",children:"\xdaltimos 30 d\xedas"}),(0,r.jsx)("option",{value:"90d",children:"\xdaltimos 90 d\xedas"})]})]})})}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,r.jsx)(d.Z,{title:"Total de Acciones",value:x.toString(),change:"\xdaltimas 24h",changeType:"neutral",icon:p.Z,iconColor:"text-blue-600"}),(0,r.jsx)(d.Z,{title:"Exitosas",value:g.toString(),change:"".concat((g/x*100).toFixed(1),"% del total"),changeType:"positive",icon:n.Z,iconColor:"text-green-600"}),(0,r.jsx)(d.Z,{title:"Fallidas",value:m.toString(),change:m>0?"Revisar causas":"Todo OK",changeType:m>0?"negative":"positive",icon:c.Z,iconColor:"text-red-600"}),(0,r.jsx)(d.Z,{title:"Advertencias",value:h.toString(),change:"Acciones sensibles",changeType:"neutral",icon:c.Z,iconColor:"text-yellow-600"})]}),(0,r.jsx)(o.Z,{data:j,title:"Actividad de Auditor\xeda por Hora",color:"#8B5CF6",height:300}),h>0&&(0,r.jsx)("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-4",children:(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)(c.Z,{className:"w-5 h-5 text-yellow-600 dark:text-yellow-400 mt-0.5 mr-3"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-yellow-800 dark:text-yellow-200",children:"Acciones Cr\xedticas Detectadas"}),(0,r.jsxs)("p",{className:"text-sm text-yellow-700 dark:text-yellow-300 mt-1",children:["Se han detectado ",h," acciones que requieren revisi\xf3n. Estas incluyen cambios en configuraciones cr\xedticas de seguridad."]})]})]})}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[(0,r.jsx)("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700",children:(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Acciones M\xe1s Frecuentes"})}),(0,r.jsx)("div",{className:"p-6",children:(0,r.jsx)("div",{className:"space-y-4",children:["UPDATE_USER","VIEW_USER_DATA","LOGIN_ATTEMPT","UPDATE_SETTINGS"].map((a,t)=>{let s=e.filter(e=>e.action===a).length;return(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("div",{className:"flex items-center space-x-2",children:(0,r.jsx)("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:a.replace(/_/g," ")})}),(0,r.jsx)("span",{className:"text-sm font-semibold text-gray-600 dark:text-gray-400",children:s})]},a)})})})]}),(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[(0,r.jsx)("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700",children:(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Usuarios M\xe1s Activos"})}),(0,r.jsx)("div",{className:"p-6",children:(0,r.jsx)("div",{className:"space-y-4",children:["Admin Usuario","Maria Garc\xeda","Carlos L\xf3pez"].map((a,t)=>{let s=e.filter(e=>e.userName===a).length;return(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"h-8 w-8 bg-gray-300 dark:bg-gray-600 rounded-full flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-xs font-medium text-gray-700 dark:text-gray-300",children:a.split(" ").map(e=>e[0]).join("")})}),(0,r.jsx)("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:a})]}),(0,r.jsxs)("span",{className:"text-sm font-semibold text-gray-600 dark:text-gray-400",children:[s," acciones"]})]},a)})})})]})]}),(0,r.jsx)(l.Z,{data:e,columns:u,title:"Registro de Auditor\xeda",onExport:()=>{console.log("Exporting audit logs...")}})]})})}},93452:function(e,a,t){"use strict";t.d(a,{Z:function(){return u}});var r=t(57437);t(2265);var s=t(35231),i=t(92566),l=t(54142),d=t(2842),o=t(9542),n=t(85475),c=t(16638);function u(e){let{data:a,dataKey:t="value",xAxisKey:u="name",title:x,color:g="#3B82F6",height:m=300,showGrid:h=!0,showTooltip:y=!0}=e;return(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[x&&(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:x}),(0,r.jsx)(s.h,{width:"100%",height:m,children:(0,r.jsxs)(i.w,{data:a,children:[h&&(0,r.jsx)(l.q,{strokeDasharray:"3 3",className:"stroke-gray-200 dark:stroke-gray-700"}),(0,r.jsx)(d.K,{dataKey:u,className:"text-gray-600 dark:text-gray-400"}),(0,r.jsx)(o.B,{className:"text-gray-600 dark:text-gray-400"}),y&&(0,r.jsx)(n.u,{contentStyle:{backgroundColor:"var(--tooltip-bg)",border:"1px solid var(--tooltip-border)",borderRadius:"6px",color:"var(--tooltip-color)"}}),(0,r.jsx)(c.x,{type:"monotone",dataKey:t,stroke:g,strokeWidth:2,dot:{fill:g,strokeWidth:2,r:4},activeDot:{r:6}})]})})]})}}},function(e){e.O(0,[4868,2465,682,7989,5079,2971,7023,1744],function(){return e(e.s=28813)}),_N_E=e.O()}]);