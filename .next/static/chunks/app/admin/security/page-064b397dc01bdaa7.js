(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[636],{93277:function(e,t,r){Promise.resolve().then(r.bind(r,63779))},63779:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return S}});var a=r(57437),s=r(2265),i=r(12020),l=r(97730),n=r(42765),d=r(60899),o=r(17901),c=r(76780),x=r(36127),g=r(208),u=r(92940),m=r(75733),h=r(74453),p=r(49321),v=r(63550),y=r(36141),b=r(71935);let j=[{id:"sec_001",type:"biometric_spoofing",severity:"critical",userId:"user_001",userName:"Usuario Sospechoso",ipAddress:"192.168.1.100",location:"Madrid, ES",userAgent:"Chrome/120.0.0.0",description:"Intento de falsificaci\xf3n biom\xe9trica detectado usando imagen est\xe1tica",timestamp:"2024-01-20T14:30:00Z",resolved:!1,actions:["Bloquear usuario","Notificar autoridades","Revisar sistema"]},{id:"sec_002",type:"failed_login",severity:"medium",userId:"user_002",userName:"Juan P\xe9rez",ipAddress:"203.0.113.45",location:"Barcelona, ES",userAgent:"Safari/17.0",description:"M\xfaltiples intentos fallidos de inicio de sesi\xf3n (5 intentos en 10 minutos)",timestamp:"2024-01-20T13:15:00Z",resolved:!0,resolvedBy:"admin",resolvedAt:"2024-01-20T13:45:00Z",actions:["Bloqueo temporal","Notificaci\xf3n por email"]},{id:"sec_003",type:"suspicious_activity",severity:"high",userId:"user_003",userName:"Mar\xeda Garc\xeda",ipAddress:"198.51.100.23",location:"Valencia, ES",userAgent:"Chrome/120.0.0.0",description:"Transacciones inusuales desde nueva ubicaci\xf3n geogr\xe1fica",timestamp:"2024-01-20T11:00:00Z",resolved:!1,actions:["Verificaci\xf3n adicional","Contactar usuario"]},{id:"sec_004",type:"fraud_attempt",severity:"critical",ipAddress:"203.0.113.66",location:"Unknown",userAgent:"Unknown Bot",description:"Intento automatizado de creaci\xf3n de cuentas falsas",timestamp:"2024-01-20T09:30:00Z",resolved:!0,resolvedBy:"security_team",resolvedAt:"2024-01-20T10:00:00Z",actions:["Bloqueo IP","Actualizar reglas WAF"]},{id:"sec_005",type:"unauthorized_access",severity:"high",userId:"user_004",userName:"Carlos L\xf3pez",ipAddress:"192.0.2.150",location:"Sevilla, ES",userAgent:"Firefox/121.0",description:"Acceso desde dispositivo no reconocido sin autenticaci\xf3n 2FA",timestamp:"2024-01-20T08:45:00Z",resolved:!1,actions:["Requiere 2FA","Verificar dispositivo"]}],k=[{name:"00:00",value:2},{name:"04:00",value:1},{name:"08:00",value:8},{name:"12:00",value:12},{name:"16:00",value:15},{name:"20:00",value:7}],f=[{name:"Intentos fallidos",value:45},{name:"Actividad sospechosa",value:23},{name:"Fraude",value:12},{name:"Acceso no autorizado",value:8},{name:"Suplantaci\xf3n biom\xe9trica",value:3}],N=e=>{let{severity:t}=e,{color:r,icon:s,text:i}=(()=>{switch(t){case"low":return{color:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",icon:u.Z,text:"Baja"};case"medium":return{color:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200",icon:c.Z,text:"Media"};case"high":return{color:"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200",icon:x.Z,text:"Alta"};case"critical":return{color:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",icon:b.Z,text:"Cr\xedtica"};default:return{color:"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200",icon:c.Z,text:"Desconocida"}}})();return(0,a.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(r),children:[(0,a.jsx)(s,{className:"w-3 h-3 mr-1"}),i]})},w=e=>{let{type:t}=e,{color:r,text:s}=(()=>{switch(t){case"failed_login":return{color:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200",text:"Intento fallido"};case"suspicious_activity":return{color:"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200",text:"Actividad sospechosa"};case"fraud_attempt":return{color:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",text:"Intento de fraude"};case"data_breach":return{color:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200",text:"Filtraci\xf3n"};case"unauthorized_access":return{color:"bg-indigo-100 text-indigo-800 dark:bg-indigo-900 dark:text-indigo-200",text:"Acceso no autorizado"};case"biometric_spoofing":return{color:"bg-pink-100 text-pink-800 dark:bg-pink-900 dark:text-pink-200",text:"Suplantaci\xf3n biom\xe9trica"};default:return{color:"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200",text:"Otro"}}})();return(0,a.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(r),children:s})},Z=e=>{let{resolved:t}=e;return(0,a.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(t?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"),children:t?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(u.Z,{className:"w-3 h-3 mr-1"}),"Resuelto"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(c.Z,{className:"w-3 h-3 mr-1"}),"Pendiente"]})})},A=e=>{let{event:t}=e,[r,i]=(0,s.useState)(!1);return(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("button",{onClick:()=>i(!r),className:"p-1 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700",children:(0,a.jsx)(v.Z,{className:"w-4 h-4"})}),r&&(0,a.jsx)("div",{className:"absolute right-0 mt-1 w-48 bg-white dark:bg-gray-800 rounded-md shadow-lg border border-gray-200 dark:border-gray-700 z-10",children:(0,a.jsxs)("div",{className:"py-1",children:[(0,a.jsxs)("button",{className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700",children:[(0,a.jsx)(m.Z,{className:"w-4 h-4 mr-2"}),"Ver detalles"]}),!t.resolved&&(0,a.jsxs)("button",{className:"flex items-center w-full px-4 py-2 text-sm text-blue-600 hover:bg-gray-100 dark:hover:bg-gray-700",children:[(0,a.jsx)(u.Z,{className:"w-4 h-4 mr-2"}),"Marcar como resuelto"]}),t.userId&&(0,a.jsxs)("button",{className:"flex items-center w-full px-4 py-2 text-sm text-red-600 hover:bg-gray-100 dark:hover:bg-gray-700",children:[(0,a.jsx)(g.Z,{className:"w-4 h-4 mr-2"}),"Bloquear usuario"]}),(0,a.jsxs)("button",{className:"flex items-center w-full px-4 py-2 text-sm text-red-600 hover:bg-gray-100 dark:hover:bg-gray-700",children:[(0,a.jsx)(h.Z,{className:"w-4 h-4 mr-2"}),"Bloquear IP"]})]})})]})};function S(){let[e]=(0,s.useState)(j),t=[{accessorKey:"timestamp",header:"Fecha y Hora",cell:e=>{let{row:t}=e,r=new Date(t.original.timestamp);return(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium text-gray-900 dark:text-white",children:r.toLocaleDateString("es-ES")}),(0,a.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:r.toLocaleTimeString("es-ES")})]})}},{accessorKey:"type",header:"Tipo",cell:e=>{let{row:t}=e;return(0,a.jsx)(w,{type:t.original.type})}},{accessorKey:"severity",header:"Severidad",cell:e=>{let{row:t}=e;return(0,a.jsx)(N,{severity:t.original.severity})}},{accessorKey:"userName",header:"Usuario",cell:e=>{let{row:t}=e;return(0,a.jsx)("div",{children:t.original.userName?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"font-medium text-gray-900 dark:text-white",children:t.original.userName}),(0,a.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:t.original.userId})]}):(0,a.jsx)("span",{className:"text-gray-500 dark:text-gray-400",children:"N/A"})})}},{accessorKey:"location",header:"Ubicaci\xf3n",cell:e=>{let{row:t}=e;return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center text-gray-900 dark:text-white",children:[(0,a.jsx)(p.Z,{className:"w-3 h-3 mr-1"}),t.original.location]}),(0,a.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:t.original.ipAddress})]})}},{accessorKey:"description",header:"Descripci\xf3n",cell:e=>{let{row:t}=e;return(0,a.jsx)("div",{className:"max-w-xs truncate",title:t.original.description,children:t.original.description})}},{accessorKey:"resolved",header:"Estado",cell:e=>{let{row:t}=e;return(0,a.jsx)(Z,{resolved:t.original.resolved})}},{id:"actions",header:"",cell:e=>{let{row:t}=e;return(0,a.jsx)(A,{event:t.original})}}],r=e.length,g=e.filter(e=>"critical"===e.severity).length,m=e.filter(e=>!e.resolved).length,h=e.filter(e=>!!e.resolved&&!!e.resolvedAt&&new Date().toDateString()===new Date(e.resolvedAt).toDateString()).length;return(0,a.jsx)(i.Z,{title:"Logs de Seguridad",description:"Monitorea y gestiona eventos de seguridad del sistema",children:(0,a.jsxs)("div",{className:"p-6 space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,a.jsx)(n.Z,{title:"Eventos Totales",value:r.toString(),change:"\xdaltimas 24h",changeType:"neutral",icon:y.Z,variant:"users"}),(0,a.jsx)(n.Z,{title:"Eventos Cr\xedticos",value:g.toString(),change:"".concat((g/r*100).toFixed(1),"% del total"),changeType:"negative",icon:x.Z,variant:"error"}),(0,a.jsx)(n.Z,{title:"Sin Resolver",value:m.toString(),change:"Requieren atenci\xf3n",changeType:"negative",icon:c.Z,variant:"warning"}),(0,a.jsx)(n.Z,{title:"Resueltos Hoy",value:h.toString(),change:"Eventos procesados",changeType:"positive",icon:u.Z,variant:"success"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsx)(d.Z,{data:k,title:"Amenazas por Hora",color:"#EF4444",height:300}),(0,a.jsx)(o.Z,{data:f,title:"Tipos de Amenazas",color:"#F97316",height:300})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[(0,a.jsx)("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700",children:(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Alertas en Tiempo Real"})}),(0,a.jsx)("div",{className:"p-6",children:(0,a.jsx)("div",{className:"space-y-4",children:e.filter(e=>!e.resolved&&"critical"===e.severity).slice(0,3).map(e=>(0,a.jsxs)("div",{className:"flex items-start space-x-3 p-4 bg-red-50 dark:bg-red-900/20 rounded-lg border border-red-200 dark:border-red-800",children:[(0,a.jsx)(x.Z,{className:"w-5 h-5 text-red-600 dark:text-red-400 mt-0.5"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("p",{className:"font-medium text-red-900 dark:text-red-100",children:["Evento Cr\xedtico - ",e.id]}),(0,a.jsx)("span",{className:"text-xs text-red-600 dark:text-red-400",children:new Date(e.timestamp).toLocaleTimeString("es-ES")})]}),(0,a.jsx)("p",{className:"text-sm text-red-800 dark:text-red-200 mt-1",children:e.description}),(0,a.jsxs)("div",{className:"flex items-center space-x-4 mt-2",children:[(0,a.jsxs)("span",{className:"text-xs text-red-600 dark:text-red-400",children:["Usuario: ",e.userName||"N/A"]}),(0,a.jsxs)("span",{className:"text-xs text-red-600 dark:text-red-400",children:["IP: ",e.ipAddress]})]})]})]},e.id))})})]}),(0,a.jsx)(l.Z,{data:e,columns:t,title:"Registro de Eventos de Seguridad",onExport:()=>{console.log("Exporting security events data...")}})]})})}}},function(e){e.O(0,[216,592,478,560],function(){return e(e.s=93277)}),_N_E=e.O()}]);