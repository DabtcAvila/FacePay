(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[971],{2974:function(e,t,i){Promise.resolve().then(i.bind(i,65221))},65221:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return c}});var r=i(57437),a=i(2265),n=i(45900);let o=e=>({NotAllowedError:"User cancelled or timeout. The user either cancelled the biometric prompt or it timed out. Try again and make sure to complete the biometric authentication.",InvalidStateError:"Authenticator already registered. This device/biometric is already registered for this user. Try signing in instead of registering.",NotSupportedError:"WebAuthn not supported on this device. Your browser or device doesn't support WebAuthn/biometric authentication.",SecurityError:"Security requirements not met. Make sure you're using HTTPS and the domain is properly configured.",ConstraintError:"Constraint error. The authenticator doesn't meet the specified requirements (e.g., platform attachment).",UnknownError:"Unknown error. An unexpected error occurred during the WebAuthn operation.",AbortError:"Operation aborted. The operation was cancelled or aborted.",NetworkError:"Network error. Failed to communicate with the server.",TimeoutError:"Operation timed out. The biometric prompt or server response took too long."})[e.name]||"".concat(e.name,": ").concat(e.message),s=e=>{try{return JSON.stringify(e,null,2)}catch(t){return String(e)}};function c(){let[e,t]=(0,a.useState)(null),[i,c]=(0,a.useState)([{name:"Browser Support Check",status:"pending"},{name:"Platform Authenticator Check",status:"pending"},{name:"Registration Options Request",status:"pending"},{name:"Registration Flow Test",status:"pending"},{name:"Authentication Options Request",status:"pending"},{name:"Authentication Flow Test",status:"pending"}]),[l,d]=(0,a.useState)([]),[u]=(0,a.useState)("test-user-".concat(Date.now())),[h,m]=(0,a.useState)(null),p=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",i=new Date().toISOString(),r=t.toUpperCase(),a="[".concat(i,"] [").concat(r,"] ").concat(e);d(e=>[...e,a]),console.log(a)},g=(e,t,i,r,a)=>{c(n=>n.map(n=>n.name===e?{...n,status:t,result:i,error:r,details:a,timestamp:new Date}:n))};(0,a.useEffect)(()=>{b()},[]);let b=async()=>{g("Browser Support Check","running"),p("Starting browser support check...");try{let e={navigator:"undefined"!=typeof navigator,credentials:"credentials"in navigator,publicKeyCredential:!!window.PublicKeyCredential,webauthn:"credentials"in navigator&&!!window.PublicKeyCredential,userAgent:navigator.userAgent,platform:navigator.platform,cookieEnabled:navigator.cookieEnabled,onLine:navigator.onLine,language:navigator.language,protocol:window.location.protocol,hostname:window.location.hostname,port:window.location.port,origin:window.location.origin};if(p("Navigator available: ".concat(e.navigator)),p("Credentials API: ".concat(e.credentials)),p("PublicKeyCredential: ".concat(e.publicKeyCredential)),p("WebAuthn supported: ".concat(e.webauthn)),p("Protocol: ".concat(e.protocol)),p("Origin: ".concat(e.origin)),p("User Agent: ".concat(e.userAgent)),!e.webauthn)throw Error("WebAuthn is not supported in this browser");"https:"!==e.protocol&&"localhost"!==e.hostname&&p("WARNING: WebAuthn requires HTTPS or localhost","warn");let i=await n.G.checkBrowserCapabilities();t(i),p("Platform authenticator available: ".concat(i.isPlatformAuthenticatorAvailable)),p("Biometric types: ".concat(i.biometricTypes.join(", "))),p("Device info: ".concat(s(i.deviceInfo))),p("Biometric availability: ".concat(s(i.biometricAvailability))),g("Browser Support Check","success",e),f(i)}catch(e){p("Browser support check failed: ".concat(e.message),"error"),g("Browser Support Check","error",null,e.message)}},f=async e=>{g("Platform Authenticator Check","running"),p("Checking platform authenticator availability...");try{let t=!1,i=!1;if(window.PublicKeyCredential){try{t=await PublicKeyCredential.isUserVerifyingPlatformAuthenticatorAvailable(),p("Platform authenticator available: ".concat(t))}catch(e){p("Error checking platform authenticator: ".concat(e.message),"warn")}try{PublicKeyCredential.isConditionalMediationAvailable?(i=await PublicKeyCredential.isConditionalMediationAvailable(),p("Conditional UI available: ".concat(i))):p("Conditional UI check not available")}catch(e){p("Error checking conditional UI: ".concat(e.message),"warn")}}let r={platformAvailable:t,conditionalAvailable:i,capabilities:e,biometricTypeName:n.G.getBiometricTypeName(e),biometricIcon:n.G.getBiometricIcon(e)};g("Platform Authenticator Check","success",r),p("Platform authenticator check completed successfully"),t||p("WARNING: No platform authenticator available. Biometric authentication will not work.","warn")}catch(e){p("Platform authenticator check failed: ".concat(e.message),"error"),g("Platform Authenticator Check","error",null,e.message)}},w=async()=>{g("Registration Options Request","running"),p("Testing registration options request...");try{var e,t,i,r,a,n;let o=await fetch("/api/webauthn/register/start",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include"}),c=await o.text();if(p("Registration options response status: ".concat(o.status)),p("Registration options response: ".concat(c)),!o.ok)throw Error("HTTP ".concat(o.status,": ").concat(c));let l=JSON.parse(c);if(!l.success||!(null===(e=l.data)||void 0===e?void 0:e.options))throw Error("Invalid response format: ".concat(c));let d=l.data.options,u={hasChallenge:!!d.publicKey.challenge,challengeLength:d.publicKey.challenge.length,hasRP:!!d.publicKey.rp,rpId:d.publicKey.rp.id,hasUser:!!d.publicKey.user,hasAlgorithms:(null===(t=d.publicKey.pubKeyCredParams)||void 0===t?void 0:t.length)>0,algorithms:null===(i=d.publicKey.pubKeyCredParams)||void 0===i?void 0:i.map(e=>e.alg),timeout:d.publicKey.timeout,attestation:d.publicKey.attestation,authenticatorAttachment:null===(r=d.publicKey.authenticatorSelection)||void 0===r?void 0:r.authenticatorAttachment,userVerification:null===(a=d.publicKey.authenticatorSelection)||void 0===a?void 0:a.userVerification,residentKey:null===(n=d.publicKey.authenticatorSelection)||void 0===n?void 0:n.residentKey};p("Registration options validation: ".concat(s(u))),g("Registration Options Request","success",{options:d,validation:u}),p("Registration options request completed successfully")}catch(e){p("Registration options request failed: ".concat(e.message),"error"),g("Registration Options Request","error",null,o(e))}},y=async()=>{g("Registration Flow Test","running"),p("Testing full registration flow...");try{p("Step 1: Getting registration options...");let e=await fetch("/api/webauthn/register/start",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include"});if(!e.ok){let t=await e.text();throw Error("Failed to get registration options: ".concat(t))}let t=(await e.json()).data.options;p("Got registration options: ".concat(s(t.publicKey))),p("Step 2: Creating WebAuthn credential...");let i=Uint8Array.from(atob(t.publicKey.challenge.replace(/-/g,"+").replace(/_/g,"/")),e=>e.charCodeAt(0)),r=Uint8Array.from(atob(t.publicKey.user.id.replace(/-/g,"+").replace(/_/g,"/")),e=>e.charCodeAt(0)),a={publicKey:{challenge:i,rp:t.publicKey.rp,user:{...t.publicKey.user,id:r},pubKeyCredParams:t.publicKey.pubKeyCredParams,timeout:t.publicKey.timeout,attestation:t.publicKey.attestation,authenticatorSelection:{authenticatorAttachment:t.publicKey.authenticatorSelection.authenticatorAttachment,userVerification:t.publicKey.authenticatorSelection.userVerification,residentKey:t.publicKey.authenticatorSelection.residentKey},excludeCredentials:t.publicKey.excludeCredentials||[]}};p("Creating credential with options: ".concat(s(a)));let n=await navigator.credentials.create(a);if(!n)throw Error("No credential returned from navigator.credentials.create()");p("Credential created successfully: ".concat(n.id)),p("Credential type: ".concat(n.type)),p("Credential response type: ".concat(n.response.constructor.name));let o=n.response,c={id:n.id,rawId:btoa(String.fromCharCode(...new Uint8Array(n.rawId))),response:{attestationObject:btoa(String.fromCharCode(...new Uint8Array(o.attestationObject))),clientDataJSON:btoa(String.fromCharCode(...new Uint8Array(o.clientDataJSON)))},type:n.type,clientExtensionResults:n.getClientExtensionResults()};p("Credential prepared for server: ".concat(s(c))),p("Step 3: Verifying credential with server...");let l=await fetch("/api/webauthn/register/complete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({credential:c}),credentials:"include"}),d=await l.text();if(p("Verification response status: ".concat(l.status)),p("Verification response: ".concat(d)),!l.ok)throw Error("Verification failed: ".concat(d));let u=JSON.parse(d);if(!u.success)throw Error("Verification unsuccessful: ".concat(d));m(c),g("Registration Flow Test","success",{credential:c,verification:u}),p("Registration flow completed successfully!","success")}catch(e){p("Registration flow failed: ".concat(e.message),"error"),p("Error details: ".concat(o(e)),"error"),g("Registration Flow Test","error",null,o(e),e.stack)}},x=async()=>{g("Authentication Options Request","running"),p("Testing authentication options request...");try{var e,t;let i=await fetch("/api/webauthn/authenticate/start",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:u}),credentials:"include"}),r=await i.text();if(p("Authentication options response status: ".concat(i.status)),p("Authentication options response: ".concat(r)),!i.ok)throw Error("HTTP ".concat(i.status,": ").concat(r));let a=JSON.parse(r);if(!a.success||!(null===(e=a.data)||void 0===e?void 0:e.options))throw Error("Invalid response format: ".concat(r));let n=a.data.options,o={hasChallenge:!!n.publicKey.challenge,challengeLength:n.publicKey.challenge.length,timeout:n.publicKey.timeout,rpId:n.publicKey.rpId,userVerification:n.publicKey.userVerification,allowCredentials:(null===(t=n.publicKey.allowCredentials)||void 0===t?void 0:t.length)||0};p("Authentication options validation: ".concat(s(o))),g("Authentication Options Request","success",{options:n,validation:o}),p("Authentication options request completed successfully")}catch(e){p("Authentication options request failed: ".concat(e.message),"error"),g("Authentication Options Request","error",null,o(e))}},v=async()=>{if(g("Authentication Flow Test","running"),p("Testing full authentication flow..."),!h){let e="No registered credential found. Please run registration test first.";p(e,"error"),g("Authentication Flow Test","error",null,e);return}try{p("Step 1: Getting authentication options...");let e=await fetch("/api/webauthn/authenticate/start",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:u}),credentials:"include"});if(!e.ok){let t=await e.text();throw Error("Failed to get authentication options: ".concat(t))}let t=(await e.json()).data.options;p("Got authentication options: ".concat(s(t.publicKey))),p("Step 2: Getting WebAuthn credential...");let i={publicKey:{challenge:Uint8Array.from(atob(t.publicKey.challenge.replace(/-/g,"+").replace(/_/g,"/")),e=>e.charCodeAt(0)),timeout:t.publicKey.timeout,rpId:t.publicKey.rpId,userVerification:t.publicKey.userVerification,allowCredentials:t.publicKey.allowCredentials||[]}};p("Getting credential with options: ".concat(s(i)));let r=await navigator.credentials.get(i);if(!r)throw Error("No credential returned from navigator.credentials.get()");p("Credential retrieved successfully: ".concat(r.id));let a=r.response,n={id:r.id,rawId:btoa(String.fromCharCode(...new Uint8Array(r.rawId))),response:{authenticatorData:btoa(String.fromCharCode(...new Uint8Array(a.authenticatorData))),clientDataJSON:btoa(String.fromCharCode(...new Uint8Array(a.clientDataJSON))),signature:btoa(String.fromCharCode(...new Uint8Array(a.signature))),userHandle:a.userHandle?btoa(String.fromCharCode(...new Uint8Array(a.userHandle))):null},type:r.type,clientExtensionResults:r.getClientExtensionResults()};p("Credential prepared for server: ".concat(s(n))),p("Step 3: Verifying credential with server...");let o=await fetch("/api/webauthn/authenticate/complete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({credential:n}),credentials:"include"}),c=await o.text();if(p("Verification response status: ".concat(o.status)),p("Verification response: ".concat(c)),!o.ok)throw Error("Verification failed: ".concat(c));let l=JSON.parse(c);if(!l.success)throw Error("Verification unsuccessful: ".concat(c));g("Authentication Flow Test","success",{credential:n,verification:l}),p("Authentication flow completed successfully!","success")}catch(e){p("Authentication flow failed: ".concat(e.message),"error"),p("Error details: ".concat(o(e)),"error"),g("Authentication Flow Test","error",null,o(e),e.stack)}},A=async()=>{p("Starting comprehensive WebAuthn test suite...","info"),c(e=>e.map(e=>({...e,status:"pending",result:void 0,error:void 0,details:void 0,timestamp:void 0}))),d([]),m(null),await b(),await new Promise(e=>setTimeout(e,1e3)),await w(),await new Promise(e=>setTimeout(e,1e3)),await y(),await new Promise(e=>setTimeout(e,1e3)),await x(),await new Promise(e=>setTimeout(e,1e3)),await v(),p("Test suite completed!","info")},N=e=>{switch(e){case"pending":return"⏳";case"running":return"\uD83D\uDD04";case"success":return"✅";case"error":return"❌";default:return"❓"}},R=e=>{switch(e){case"pending":default:return"text-gray-500";case"running":return"text-blue-500";case"success":return"text-green-500";case"error":return"text-red-500"}};return(0,r.jsxs)("div",{className:"container mx-auto p-6 max-w-6xl",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold mb-6",children:"WebAuthn Debug Test Suite"}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("p",{className:"text-gray-600 mb-4",children:"This comprehensive test suite helps diagnose WebAuthn/biometric authentication issues. Each test provides detailed logging and error information to identify problems."}),(0,r.jsxs)("div",{className:"flex gap-4 mb-4",children:[(0,r.jsx)("button",{onClick:A,className:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600",children:"Run All Tests"}),(0,r.jsx)("button",{onClick:()=>{d([])},className:"bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600",children:"Clear Logs"})]})]}),(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-8",children:i.map((e,t)=>(0,r.jsxs)("div",{className:"border rounded-lg p-4 bg-white shadow",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsx)("h3",{className:"font-semibold text-sm",children:e.name}),(0,r.jsx)("span",{className:"text-xl ".concat(R(e.status)),children:N(e.status)})]}),(0,r.jsx)("div",{className:"text-sm ".concat(R(e.status)),children:e.status.charAt(0).toUpperCase()+e.status.slice(1)}),e.timestamp&&(0,r.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:e.timestamp.toLocaleTimeString()}),e.error&&(0,r.jsxs)("div",{className:"text-xs text-red-600 mt-2 p-2 bg-red-50 rounded",children:[(0,r.jsx)("strong",{children:"Error:"})," ",e.error]})]},t))}),e&&(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Browser Capabilities"}),(0,r.jsxs)("div",{className:"bg-white border rounded-lg p-4 shadow",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-semibold mb-2",children:"WebAuthn Support"}),(0,r.jsxs)("ul",{className:"text-sm space-y-1",children:[(0,r.jsxs)("li",{children:["Supported: ",e.isSupported?"✅":"❌"]}),(0,r.jsxs)("li",{children:["Platform Authenticator: ",e.isPlatformAuthenticatorAvailable?"✅":"❌"]}),(0,r.jsxs)("li",{children:["Biometric Types: ",e.biometricTypes.join(", ")||"None detected"]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-semibold mb-2",children:"Device Information"}),(0,r.jsxs)("ul",{className:"text-sm space-y-1",children:[(0,r.jsxs)("li",{children:["Platform: ",e.deviceInfo.platform]}),(0,r.jsxs)("li",{children:["Mobile: ",e.deviceInfo.isMobile?"✅":"❌"]}),(0,r.jsxs)("li",{children:["iOS: ",e.deviceInfo.isIOS?"✅":"❌"]}),(0,r.jsxs)("li",{children:["Android: ",e.deviceInfo.isAndroid?"✅":"❌"]}),(0,r.jsxs)("li",{children:["macOS: ",e.deviceInfo.isMacOS?"✅":"❌"]}),(0,r.jsxs)("li",{children:["Windows: ",e.deviceInfo.isWindows?"✅":"❌"]})]})]})]}),(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsx)("h3",{className:"font-semibold mb-2",children:"Biometric Availability"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-2 text-sm",children:[(0,r.jsxs)("div",{children:["Face ID: ",e.biometricAvailability.faceID?"✅":"❌"]}),(0,r.jsxs)("div",{children:["Touch ID: ",e.biometricAvailability.touchID?"✅":"❌"]}),(0,r.jsxs)("div",{children:["Windows Hello: ",e.biometricAvailability.windowsHello?"✅":"❌"]}),(0,r.jsxs)("div",{children:["Android Face: ",e.biometricAvailability.androidFace?"✅":"❌"]}),(0,r.jsxs)("div",{children:["Android Fingerprint: ",e.biometricAvailability.androidFingerprint?"✅":"❌"]})]})]}),(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsx)("h3",{className:"font-semibold mb-2",children:"Recommended Authentication"}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:[n.G.getBiometricIcon(e)," ",n.G.getBiometricTypeName(e)]})]})]})]}),(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Individual Tests"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,r.jsxs)("button",{onClick:b,className:"p-4 border rounded-lg hover:bg-gray-50 text-left",children:[(0,r.jsx)("h3",{className:"font-semibold",children:"1. Browser Support"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Check WebAuthn API availability"})]}),(0,r.jsxs)("button",{onClick:w,className:"p-4 border rounded-lg hover:bg-gray-50 text-left",children:[(0,r.jsx)("h3",{className:"font-semibold",children:"2. Registration Options"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Test server registration endpoint"})]}),(0,r.jsxs)("button",{onClick:y,className:"p-4 border rounded-lg hover:bg-gray-50 text-left",children:[(0,r.jsx)("h3",{className:"font-semibold",children:"3. Registration Flow"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Full biometric registration test"})]}),(0,r.jsxs)("button",{onClick:x,className:"p-4 border rounded-lg hover:bg-gray-50 text-left",children:[(0,r.jsx)("h3",{className:"font-semibold",children:"4. Auth Options"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Test server authentication endpoint"})]}),(0,r.jsxs)("button",{onClick:v,className:"p-4 border rounded-lg hover:bg-gray-50 text-left",children:[(0,r.jsx)("h3",{className:"font-semibold",children:"5. Authentication Flow"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Full biometric authentication test"})]})]})]}),(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Test Results"}),(0,r.jsx)("div",{className:"space-y-4",children:i.filter(e=>e.result||e.error).map((e,t)=>(0,r.jsxs)("div",{className:"bg-white border rounded-lg p-4 shadow",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsx)("h3",{className:"font-semibold",children:e.name}),(0,r.jsxs)("span",{className:R(e.status),children:[N(e.status)," ",e.status]})]}),e.result&&(0,r.jsxs)("div",{className:"mb-2",children:[(0,r.jsx)("h4",{className:"font-medium text-sm text-green-600 mb-1",children:"Result:"}),(0,r.jsx)("pre",{className:"text-xs bg-green-50 p-2 rounded overflow-auto max-h-40",children:s(e.result)})]}),e.error&&(0,r.jsxs)("div",{className:"mb-2",children:[(0,r.jsx)("h4",{className:"font-medium text-sm text-red-600 mb-1",children:"Error:"}),(0,r.jsx)("div",{className:"text-xs bg-red-50 p-2 rounded",children:e.error})]}),e.details&&(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-medium text-sm text-gray-600 mb-1",children:"Details:"}),(0,r.jsx)("pre",{className:"text-xs bg-gray-50 p-2 rounded overflow-auto max-h-40",children:e.details})]})]},t))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Debug Logs"}),(0,r.jsx)("div",{className:"bg-black text-green-400 p-4 rounded-lg font-mono text-xs max-h-96 overflow-auto",children:0===l.length?(0,r.jsx)("div",{className:"text-gray-500",children:"No logs yet. Run tests to see detailed logging information."}):l.map((e,t)=>(0,r.jsx)("div",{className:"mb-1",children:e},t))})]}),(0,r.jsxs)("div",{className:"mt-8 bg-blue-50 border border-blue-200 rounded-lg p-6",children:[(0,r.jsx)("h2",{className:"text-xl font-bold mb-4 text-blue-800",children:"Common Issues & Solutions"}),(0,r.jsxs)("div",{className:"space-y-4 text-sm",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-semibold text-blue-700",children:"NotSupportedError"}),(0,r.jsx)("p",{children:"WebAuthn not supported. Try Chrome/Safari on a device with biometric sensors (iPhone with Face ID/Touch ID, Mac with Touch ID, Windows with Windows Hello)."})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-semibold text-blue-700",children:"NotAllowedError"}),(0,r.jsx)("p",{children:"User cancelled or timeout. Make sure to complete the biometric prompt when it appears. Check if biometric authentication is enabled in device settings."})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-semibold text-blue-700",children:"SecurityError"}),(0,r.jsx)("p",{children:"Security requirements not met. Ensure you're using HTTPS (or localhost for development) and the domain is properly configured."})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-semibold text-blue-700",children:"InvalidStateError"}),(0,r.jsx)("p",{children:"Authenticator already registered. Try authentication instead, or clear existing credentials and register again."})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-semibold text-blue-700",children:"No Platform Authenticator"}),(0,r.jsx)("p",{children:"Device doesn't have a built-in biometric sensor or it's disabled. Check device settings for Face ID, Touch ID, Windows Hello, etc."})]})]})]})]})}},74550:function(e,t,i){"use strict";function r(e){let t=new Uint8Array(e),i="";for(let e of t)i+=String.fromCharCode(e);return btoa(i).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function a(e){let t=e.replace(/-/g,"+").replace(/_/g,"/"),i=(4-t.length%4)%4,r=atob(t.padEnd(t.length+i,"=")),a=new ArrayBuffer(r.length),n=new Uint8Array(a);for(let e=0;e<r.length;e++)n[e]=r.charCodeAt(e);return a}function n(){return window?.PublicKeyCredential!==void 0&&"function"==typeof window.PublicKeyCredential}function o(e){let{id:t}=e;return{...e,id:a(t),transports:e.transports}}function s(e){return"localhost"===e||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}i.d(t,{RQ:function(){return m},oz:function(){return g}});class c extends Error{constructor({message:e,code:t,cause:i,name:r}){super(e,{cause:i}),this.name=r??i.name,this.code=t}}class l{createNewAbortSignal(){if(this.controller){let e=Error("Cancelling existing WebAuthn API call for new one");e.name="AbortError",this.controller.abort(e)}let e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){let e=Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}let d=new l,u=["cross-platform","platform"];function h(e){if(!(!e||0>u.indexOf(e)))return e}async function m(e){var t;let i,l,u,m,g;if(!n())throw Error("WebAuthn is not supported in this browser");let b={publicKey:{...e,challenge:a(e.challenge),user:{...e.user,id:(t=e.user.id,new TextEncoder().encode(t))},excludeCredentials:e.excludeCredentials?.map(o)}};b.signal=d.createNewAbortSignal();try{i=await navigator.credentials.create(b)}catch(e){throw function({error:e,options:t}){let{publicKey:i}=t;if(!i)throw Error("options was missing required publicKey property");if("AbortError"===e.name){if(t.signal instanceof AbortSignal)return new c({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if("ConstraintError"===e.name){if(i.authenticatorSelection?.requireResidentKey===!0)return new c({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(i.authenticatorSelection?.userVerification==="required")return new c({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else if("InvalidStateError"===e.name)return new c({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});else if("NotAllowedError"===e.name)return new c({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});else if("NotSupportedError"===e.name)return new c(0===i.pubKeyCredParams.filter(e=>"public-key"===e.type).length?{message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}:{message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});else if("SecurityError"===e.name){let t=window.location.hostname;if(!s(t))return new c({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e});if(i.rp.id!==t)return new c({message:`The RP ID "${i.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else if("TypeError"===e.name){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new c({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if("UnknownError"===e.name)return new c({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e});return e}({error:e,options:b})}if(!i)throw Error("Registration was not completed");let{id:f,rawId:w,response:y,type:x}=i;if("function"==typeof y.getTransports&&(u=y.getTransports()),"function"==typeof y.getPublicKeyAlgorithm)try{m=y.getPublicKeyAlgorithm()}catch(e){p("getPublicKeyAlgorithm()",e)}if("function"==typeof y.getPublicKey)try{let e=y.getPublicKey();null!==e&&(g=r(e))}catch(e){p("getPublicKey()",e)}if("function"==typeof y.getAuthenticatorData)try{l=r(y.getAuthenticatorData())}catch(e){p("getAuthenticatorData()",e)}return{id:f,rawId:r(w),response:{attestationObject:r(y.attestationObject),clientDataJSON:r(y.clientDataJSON),transports:u,publicKeyAlgorithm:m,publicKey:g,authenticatorData:l},type:x,clientExtensionResults:i.getClientExtensionResults(),authenticatorAttachment:h(i.authenticatorAttachment)}}function p(e,t){console.warn(`The browser extension that intercepted this WebAuthn API call incorrectly implemented ${e}. You should report this error to them.
`,t)}async function g(e,t=!1){let i,l,u;if(!n())throw Error("WebAuthn is not supported in this browser");e.allowCredentials?.length!==0&&(i=e.allowCredentials?.map(o));let m={...e,challenge:a(e.challenge),allowCredentials:i},p={};if(t){if(!await function(){let e=window.PublicKeyCredential;return void 0===e.isConditionalMediationAvailable?new Promise(e=>e(!1)):e.isConditionalMediationAvailable()}())throw Error("Browser does not support WebAuthn autofill");if(document.querySelectorAll("input[autocomplete$='webauthn']").length<1)throw Error('No <input> with "webauthn" as the only or last value in its `autocomplete` attribute was detected');p.mediation="conditional",m.allowCredentials=[]}p.publicKey=m,p.signal=d.createNewAbortSignal();try{l=await navigator.credentials.get(p)}catch(e){throw function({error:e,options:t}){let{publicKey:i}=t;if(!i)throw Error("options was missing required publicKey property");if("AbortError"===e.name){if(t.signal instanceof AbortSignal)return new c({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if("NotAllowedError"===e.name)return new c({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});else if("SecurityError"===e.name){let t=window.location.hostname;if(!s(t))return new c({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e});if(i.rpId!==t)return new c({message:`The RP ID "${i.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else if("UnknownError"===e.name)return new c({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e});return e}({error:e,options:p})}if(!l)throw Error("Authentication was not completed");let{id:g,rawId:b,response:f,type:w}=l;if(f.userHandle){var y;y=f.userHandle,u=new TextDecoder("utf-8").decode(y)}return{id:g,rawId:r(b),response:{authenticatorData:r(f.authenticatorData),clientDataJSON:r(f.clientDataJSON),signature:r(f.signature),userHandle:u},type:w,clientExtensionResults:l.getClientExtensionResults(),authenticatorAttachment:h(l.authenticatorAttachment)}}}},function(e){e.O(0,[5900,2971,7023,1744],function(){return e(e.s=2974)}),_N_E=e.O()}]);