(()=>{var e={};e.id=971,e.ids=[971],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},21881:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>s.a,__next_app__:()=>h,originalPathname:()=>u,pages:()=>d,routeModule:()=>p,tree:()=>c}),r(42576),r(79286),r(7629),r(12523);var i=r(23191),a=r(88716),n=r(37922),s=r.n(n),o=r(95231),l={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);r.d(t,l);let c=["",{children:["test-webauthn",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,42576)),"/Users/davicho/MASTER proyectos/FacePay/src/app/test-webauthn/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,79286)),"/Users/davicho/MASTER proyectos/FacePay/src/app/layout.tsx"],error:[()=>Promise.resolve().then(r.bind(r,7629)),"/Users/davicho/MASTER proyectos/FacePay/src/app/error.tsx"],"not-found":[()=>Promise.resolve().then(r.bind(r,12523)),"/Users/davicho/MASTER proyectos/FacePay/src/app/not-found.tsx"]}],d=["/Users/davicho/MASTER proyectos/FacePay/src/app/test-webauthn/page.tsx"],u="/test-webauthn/page",h={require:r,loadChunk:()=>Promise.resolve()},p=new i.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/test-webauthn/page",pathname:"/test-webauthn",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},43684:(e,t,r)=>{Promise.resolve().then(r.bind(r,11173))},11173:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>l});var i=r(10326),a=r(17577),n=r(36402);let s=e=>({NotAllowedError:"User cancelled or timeout. The user either cancelled the biometric prompt or it timed out. Try again and make sure to complete the biometric authentication.",InvalidStateError:"Authenticator already registered. This device/biometric is already registered for this user. Try signing in instead of registering.",NotSupportedError:"WebAuthn not supported on this device. Your browser or device doesn't support WebAuthn/biometric authentication.",SecurityError:"Security requirements not met. Make sure you're using HTTPS and the domain is properly configured.",ConstraintError:"Constraint error. The authenticator doesn't meet the specified requirements (e.g., platform attachment).",UnknownError:"Unknown error. An unexpected error occurred during the WebAuthn operation.",AbortError:"Operation aborted. The operation was cancelled or aborted.",NetworkError:"Network error. Failed to communicate with the server.",TimeoutError:"Operation timed out. The biometric prompt or server response took too long."})[e.name]||`${e.name}: ${e.message}`,o=e=>{try{return JSON.stringify(e,null,2)}catch{return String(e)}};function l(){let[e,t]=(0,a.useState)(null),[r,l]=(0,a.useState)([{name:"Browser Support Check",status:"pending"},{name:"Platform Authenticator Check",status:"pending"},{name:"Registration Options Request",status:"pending"},{name:"Registration Flow Test",status:"pending"},{name:"Authentication Options Request",status:"pending"},{name:"Authentication Flow Test",status:"pending"}]),[c,d]=(0,a.useState)([]),[u]=(0,a.useState)(`test-user-${Date.now()}`),[h,p]=(0,a.useState)(null),m=(e,t="info")=>{let r=new Date().toISOString(),i=t.toUpperCase(),a=`[${r}] [${i}] ${e}`;d(e=>[...e,a]),console.log(a)},g=(e,t,r,i,a)=>{l(n=>n.map(n=>n.name===e?{...n,status:t,result:r,error:i,details:a,timestamp:new Date}:n))},b=async()=>{g("Browser Support Check","running"),m("Starting browser support check...");try{let e={navigator:"undefined"!=typeof navigator,credentials:"credentials"in navigator,publicKeyCredential:!1,webauthn:!1,userAgent:navigator.userAgent,platform:navigator.platform,cookieEnabled:navigator.cookieEnabled,onLine:navigator.onLine,language:navigator.language,protocol:window.location.protocol,hostname:window.location.hostname,port:window.location.port,origin:window.location.origin};if(m(`Navigator available: ${e.navigator}`),m(`Credentials API: ${e.credentials}`),m(`PublicKeyCredential: ${e.publicKeyCredential}`),m(`WebAuthn supported: ${e.webauthn}`),m(`Protocol: ${e.protocol}`),m(`Origin: ${e.origin}`),m(`User Agent: ${e.userAgent}`),!e.webauthn)throw Error("WebAuthn is not supported in this browser");"https:"!==e.protocol&&"localhost"!==e.hostname&&m("WARNING: WebAuthn requires HTTPS or localhost","warn");let r=await n.G.checkBrowserCapabilities();t(r),m(`Platform authenticator available: ${r.isPlatformAuthenticatorAvailable}`),m(`Biometric types: ${r.biometricTypes.join(", ")}`),m(`Device info: ${o(r.deviceInfo)}`),m(`Biometric availability: ${o(r.biometricAvailability)}`),g("Browser Support Check","success",e),f(r)}catch(e){m(`Browser support check failed: ${e.message}`,"error"),g("Browser Support Check","error",null,e.message)}},f=async e=>{g("Platform Authenticator Check","running"),m("Checking platform authenticator availability...");try{let t=!1,r=!1;if(window.PublicKeyCredential){try{t=await PublicKeyCredential.isUserVerifyingPlatformAuthenticatorAvailable(),m(`Platform authenticator available: ${t}`)}catch(e){m(`Error checking platform authenticator: ${e.message}`,"warn")}try{PublicKeyCredential.isConditionalMediationAvailable?(r=await PublicKeyCredential.isConditionalMediationAvailable(),m(`Conditional UI available: ${r}`)):m("Conditional UI check not available")}catch(e){m(`Error checking conditional UI: ${e.message}`,"warn")}}let i={platformAvailable:t,conditionalAvailable:r,capabilities:e,biometricTypeName:n.G.getBiometricTypeName(e),biometricIcon:n.G.getBiometricIcon(e)};g("Platform Authenticator Check","success",i),m("Platform authenticator check completed successfully"),t||m("WARNING: No platform authenticator available. Biometric authentication will not work.","warn")}catch(e){m(`Platform authenticator check failed: ${e.message}`,"error"),g("Platform Authenticator Check","error",null,e.message)}},w=async()=>{g("Registration Options Request","running"),m("Testing registration options request...");try{let e=await fetch("/api/webauthn/register/start",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include"}),t=await e.text();if(m(`Registration options response status: ${e.status}`),m(`Registration options response: ${t}`),!e.ok)throw Error(`HTTP ${e.status}: ${t}`);let r=JSON.parse(t);if(!r.success||!r.data?.options)throw Error(`Invalid response format: ${t}`);let i=r.data.options,a={hasChallenge:!!i.publicKey.challenge,challengeLength:i.publicKey.challenge.length,hasRP:!!i.publicKey.rp,rpId:i.publicKey.rp.id,hasUser:!!i.publicKey.user,hasAlgorithms:i.publicKey.pubKeyCredParams?.length>0,algorithms:i.publicKey.pubKeyCredParams?.map(e=>e.alg),timeout:i.publicKey.timeout,attestation:i.publicKey.attestation,authenticatorAttachment:i.publicKey.authenticatorSelection?.authenticatorAttachment,userVerification:i.publicKey.authenticatorSelection?.userVerification,residentKey:i.publicKey.authenticatorSelection?.residentKey};m(`Registration options validation: ${o(a)}`),g("Registration Options Request","success",{options:i,validation:a}),m("Registration options request completed successfully")}catch(e){m(`Registration options request failed: ${e.message}`,"error"),g("Registration Options Request","error",null,s(e))}},y=async()=>{g("Registration Flow Test","running"),m("Testing full registration flow...");try{m("Step 1: Getting registration options...");let e=await fetch("/api/webauthn/register/start",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include"});if(!e.ok){let t=await e.text();throw Error(`Failed to get registration options: ${t}`)}let t=(await e.json()).data.options;m(`Got registration options: ${o(t.publicKey)}`),m("Step 2: Creating WebAuthn credential...");let r=Uint8Array.from(atob(t.publicKey.challenge.replace(/-/g,"+").replace(/_/g,"/")),e=>e.charCodeAt(0)),i=Uint8Array.from(atob(t.publicKey.user.id.replace(/-/g,"+").replace(/_/g,"/")),e=>e.charCodeAt(0)),a={publicKey:{challenge:r,rp:t.publicKey.rp,user:{...t.publicKey.user,id:i},pubKeyCredParams:t.publicKey.pubKeyCredParams,timeout:t.publicKey.timeout,attestation:t.publicKey.attestation,authenticatorSelection:{authenticatorAttachment:t.publicKey.authenticatorSelection.authenticatorAttachment,userVerification:t.publicKey.authenticatorSelection.userVerification,residentKey:t.publicKey.authenticatorSelection.residentKey},excludeCredentials:t.publicKey.excludeCredentials||[]}};m(`Creating credential with options: ${o(a)}`);let n=await navigator.credentials.create(a);if(!n)throw Error("No credential returned from navigator.credentials.create()");m(`Credential created successfully: ${n.id}`),m(`Credential type: ${n.type}`),m(`Credential response type: ${n.response.constructor.name}`);let s=n.response,l={id:n.id,rawId:btoa(String.fromCharCode(...new Uint8Array(n.rawId))),response:{attestationObject:btoa(String.fromCharCode(...new Uint8Array(s.attestationObject))),clientDataJSON:btoa(String.fromCharCode(...new Uint8Array(s.clientDataJSON)))},type:n.type,clientExtensionResults:n.getClientExtensionResults()};m(`Credential prepared for server: ${o(l)}`),m("Step 3: Verifying credential with server...");let c=await fetch("/api/webauthn/register/complete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({credential:l}),credentials:"include"}),d=await c.text();if(m(`Verification response status: ${c.status}`),m(`Verification response: ${d}`),!c.ok)throw Error(`Verification failed: ${d}`);let u=JSON.parse(d);if(!u.success)throw Error(`Verification unsuccessful: ${d}`);p(l),g("Registration Flow Test","success",{credential:l,verification:u}),m("Registration flow completed successfully!","success")}catch(e){m(`Registration flow failed: ${e.message}`,"error"),m(`Error details: ${s(e)}`,"error"),g("Registration Flow Test","error",null,s(e),e.stack)}},x=async()=>{g("Authentication Options Request","running"),m("Testing authentication options request...");try{let e=await fetch("/api/webauthn/authenticate/start",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:u}),credentials:"include"}),t=await e.text();if(m(`Authentication options response status: ${e.status}`),m(`Authentication options response: ${t}`),!e.ok)throw Error(`HTTP ${e.status}: ${t}`);let r=JSON.parse(t);if(!r.success||!r.data?.options)throw Error(`Invalid response format: ${t}`);let i=r.data.options,a={hasChallenge:!!i.publicKey.challenge,challengeLength:i.publicKey.challenge.length,timeout:i.publicKey.timeout,rpId:i.publicKey.rpId,userVerification:i.publicKey.userVerification,allowCredentials:i.publicKey.allowCredentials?.length||0};m(`Authentication options validation: ${o(a)}`),g("Authentication Options Request","success",{options:i,validation:a}),m("Authentication options request completed successfully")}catch(e){m(`Authentication options request failed: ${e.message}`,"error"),g("Authentication Options Request","error",null,s(e))}},A=async()=>{if(g("Authentication Flow Test","running"),m("Testing full authentication flow..."),!h){let e="No registered credential found. Please run registration test first.";m(e,"error"),g("Authentication Flow Test","error",null,e);return}try{m("Step 1: Getting authentication options...");let e=await fetch("/api/webauthn/authenticate/start",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:u}),credentials:"include"});if(!e.ok){let t=await e.text();throw Error(`Failed to get authentication options: ${t}`)}let t=(await e.json()).data.options;m(`Got authentication options: ${o(t.publicKey)}`),m("Step 2: Getting WebAuthn credential...");let r={publicKey:{challenge:Uint8Array.from(atob(t.publicKey.challenge.replace(/-/g,"+").replace(/_/g,"/")),e=>e.charCodeAt(0)),timeout:t.publicKey.timeout,rpId:t.publicKey.rpId,userVerification:t.publicKey.userVerification,allowCredentials:t.publicKey.allowCredentials||[]}};m(`Getting credential with options: ${o(r)}`);let i=await navigator.credentials.get(r);if(!i)throw Error("No credential returned from navigator.credentials.get()");m(`Credential retrieved successfully: ${i.id}`);let a=i.response,n={id:i.id,rawId:btoa(String.fromCharCode(...new Uint8Array(i.rawId))),response:{authenticatorData:btoa(String.fromCharCode(...new Uint8Array(a.authenticatorData))),clientDataJSON:btoa(String.fromCharCode(...new Uint8Array(a.clientDataJSON))),signature:btoa(String.fromCharCode(...new Uint8Array(a.signature))),userHandle:a.userHandle?btoa(String.fromCharCode(...new Uint8Array(a.userHandle))):null},type:i.type,clientExtensionResults:i.getClientExtensionResults()};m(`Credential prepared for server: ${o(n)}`),m("Step 3: Verifying credential with server...");let s=await fetch("/api/webauthn/authenticate/complete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({credential:n}),credentials:"include"}),l=await s.text();if(m(`Verification response status: ${s.status}`),m(`Verification response: ${l}`),!s.ok)throw Error(`Verification failed: ${l}`);let c=JSON.parse(l);if(!c.success)throw Error(`Verification unsuccessful: ${l}`);g("Authentication Flow Test","success",{credential:n,verification:c}),m("Authentication flow completed successfully!","success")}catch(e){m(`Authentication flow failed: ${e.message}`,"error"),m(`Error details: ${s(e)}`,"error"),g("Authentication Flow Test","error",null,s(e),e.stack)}},v=async()=>{m("Starting comprehensive WebAuthn test suite...","info"),l(e=>e.map(e=>({...e,status:"pending",result:void 0,error:void 0,details:void 0,timestamp:void 0}))),d([]),p(null),await b(),await new Promise(e=>setTimeout(e,1e3)),await w(),await new Promise(e=>setTimeout(e,1e3)),await y(),await new Promise(e=>setTimeout(e,1e3)),await x(),await new Promise(e=>setTimeout(e,1e3)),await A(),m("Test suite completed!","info")},R=e=>{switch(e){case"pending":return"⏳";case"running":return"\uD83D\uDD04";case"success":return"✅";case"error":return"❌";default:return"❓"}},N=e=>{switch(e){case"pending":default:return"text-gray-500";case"running":return"text-blue-500";case"success":return"text-green-500";case"error":return"text-red-500"}};return(0,i.jsxs)("div",{className:"container mx-auto p-6 max-w-6xl",children:[i.jsx("h1",{className:"text-3xl font-bold mb-6",children:"WebAuthn Debug Test Suite"}),(0,i.jsxs)("div",{className:"mb-6",children:[i.jsx("p",{className:"text-gray-600 mb-4",children:"This comprehensive test suite helps diagnose WebAuthn/biometric authentication issues. Each test provides detailed logging and error information to identify problems."}),(0,i.jsxs)("div",{className:"flex gap-4 mb-4",children:[i.jsx("button",{onClick:v,className:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600",children:"Run All Tests"}),i.jsx("button",{onClick:()=>{d([])},className:"bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600",children:"Clear Logs"})]})]}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-8",children:r.map((e,t)=>(0,i.jsxs)("div",{className:"border rounded-lg p-4 bg-white shadow",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"font-semibold text-sm",children:e.name}),i.jsx("span",{className:`text-xl ${N(e.status)}`,children:R(e.status)})]}),i.jsx("div",{className:`text-sm ${N(e.status)}`,children:e.status.charAt(0).toUpperCase()+e.status.slice(1)}),e.timestamp&&i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:e.timestamp.toLocaleTimeString()}),e.error&&(0,i.jsxs)("div",{className:"text-xs text-red-600 mt-2 p-2 bg-red-50 rounded",children:[i.jsx("strong",{children:"Error:"})," ",e.error]})]},t))}),e&&(0,i.jsxs)("div",{className:"mb-8",children:[i.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Browser Capabilities"}),(0,i.jsxs)("div",{className:"bg-white border rounded-lg p-4 shadow",children:[(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,i.jsxs)("div",{children:[i.jsx("h3",{className:"font-semibold mb-2",children:"WebAuthn Support"}),(0,i.jsxs)("ul",{className:"text-sm space-y-1",children:[(0,i.jsxs)("li",{children:["Supported: ",e.isSupported?"✅":"❌"]}),(0,i.jsxs)("li",{children:["Platform Authenticator: ",e.isPlatformAuthenticatorAvailable?"✅":"❌"]}),(0,i.jsxs)("li",{children:["Biometric Types: ",e.biometricTypes.join(", ")||"None detected"]})]})]}),(0,i.jsxs)("div",{children:[i.jsx("h3",{className:"font-semibold mb-2",children:"Device Information"}),(0,i.jsxs)("ul",{className:"text-sm space-y-1",children:[(0,i.jsxs)("li",{children:["Platform: ",e.deviceInfo.platform]}),(0,i.jsxs)("li",{children:["Mobile: ",e.deviceInfo.isMobile?"✅":"❌"]}),(0,i.jsxs)("li",{children:["iOS: ",e.deviceInfo.isIOS?"✅":"❌"]}),(0,i.jsxs)("li",{children:["Android: ",e.deviceInfo.isAndroid?"✅":"❌"]}),(0,i.jsxs)("li",{children:["macOS: ",e.deviceInfo.isMacOS?"✅":"❌"]}),(0,i.jsxs)("li",{children:["Windows: ",e.deviceInfo.isWindows?"✅":"❌"]})]})]})]}),(0,i.jsxs)("div",{className:"mt-4",children:[i.jsx("h3",{className:"font-semibold mb-2",children:"Biometric Availability"}),(0,i.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-2 text-sm",children:[(0,i.jsxs)("div",{children:["Face ID: ",e.biometricAvailability.faceID?"✅":"❌"]}),(0,i.jsxs)("div",{children:["Touch ID: ",e.biometricAvailability.touchID?"✅":"❌"]}),(0,i.jsxs)("div",{children:["Windows Hello: ",e.biometricAvailability.windowsHello?"✅":"❌"]}),(0,i.jsxs)("div",{children:["Android Face: ",e.biometricAvailability.androidFace?"✅":"❌"]}),(0,i.jsxs)("div",{children:["Android Fingerprint: ",e.biometricAvailability.androidFingerprint?"✅":"❌"]})]})]}),(0,i.jsxs)("div",{className:"mt-4",children:[i.jsx("h3",{className:"font-semibold mb-2",children:"Recommended Authentication"}),(0,i.jsxs)("p",{className:"text-sm text-gray-600",children:[n.G.getBiometricIcon(e)," ",n.G.getBiometricTypeName(e)]})]})]})]}),(0,i.jsxs)("div",{className:"mb-8",children:[i.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Individual Tests"}),(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,i.jsxs)("button",{onClick:b,className:"p-4 border rounded-lg hover:bg-gray-50 text-left",children:[i.jsx("h3",{className:"font-semibold",children:"1. Browser Support"}),i.jsx("p",{className:"text-sm text-gray-600",children:"Check WebAuthn API availability"})]}),(0,i.jsxs)("button",{onClick:w,className:"p-4 border rounded-lg hover:bg-gray-50 text-left",children:[i.jsx("h3",{className:"font-semibold",children:"2. Registration Options"}),i.jsx("p",{className:"text-sm text-gray-600",children:"Test server registration endpoint"})]}),(0,i.jsxs)("button",{onClick:y,className:"p-4 border rounded-lg hover:bg-gray-50 text-left",children:[i.jsx("h3",{className:"font-semibold",children:"3. Registration Flow"}),i.jsx("p",{className:"text-sm text-gray-600",children:"Full biometric registration test"})]}),(0,i.jsxs)("button",{onClick:x,className:"p-4 border rounded-lg hover:bg-gray-50 text-left",children:[i.jsx("h3",{className:"font-semibold",children:"4. Auth Options"}),i.jsx("p",{className:"text-sm text-gray-600",children:"Test server authentication endpoint"})]}),(0,i.jsxs)("button",{onClick:A,className:"p-4 border rounded-lg hover:bg-gray-50 text-left",children:[i.jsx("h3",{className:"font-semibold",children:"5. Authentication Flow"}),i.jsx("p",{className:"text-sm text-gray-600",children:"Full biometric authentication test"})]})]})]}),(0,i.jsxs)("div",{className:"mb-8",children:[i.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Test Results"}),i.jsx("div",{className:"space-y-4",children:r.filter(e=>e.result||e.error).map((e,t)=>(0,i.jsxs)("div",{className:"bg-white border rounded-lg p-4 shadow",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"font-semibold",children:e.name}),(0,i.jsxs)("span",{className:N(e.status),children:[R(e.status)," ",e.status]})]}),e.result&&(0,i.jsxs)("div",{className:"mb-2",children:[i.jsx("h4",{className:"font-medium text-sm text-green-600 mb-1",children:"Result:"}),i.jsx("pre",{className:"text-xs bg-green-50 p-2 rounded overflow-auto max-h-40",children:o(e.result)})]}),e.error&&(0,i.jsxs)("div",{className:"mb-2",children:[i.jsx("h4",{className:"font-medium text-sm text-red-600 mb-1",children:"Error:"}),i.jsx("div",{className:"text-xs bg-red-50 p-2 rounded",children:e.error})]}),e.details&&(0,i.jsxs)("div",{children:[i.jsx("h4",{className:"font-medium text-sm text-gray-600 mb-1",children:"Details:"}),i.jsx("pre",{className:"text-xs bg-gray-50 p-2 rounded overflow-auto max-h-40",children:e.details})]})]},t))})]}),(0,i.jsxs)("div",{children:[i.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Debug Logs"}),i.jsx("div",{className:"bg-black text-green-400 p-4 rounded-lg font-mono text-xs max-h-96 overflow-auto",children:0===c.length?i.jsx("div",{className:"text-gray-500",children:"No logs yet. Run tests to see detailed logging information."}):c.map((e,t)=>i.jsx("div",{className:"mb-1",children:e},t))})]}),(0,i.jsxs)("div",{className:"mt-8 bg-blue-50 border border-blue-200 rounded-lg p-6",children:[i.jsx("h2",{className:"text-xl font-bold mb-4 text-blue-800",children:"Common Issues & Solutions"}),(0,i.jsxs)("div",{className:"space-y-4 text-sm",children:[(0,i.jsxs)("div",{children:[i.jsx("h3",{className:"font-semibold text-blue-700",children:"NotSupportedError"}),i.jsx("p",{children:"WebAuthn not supported. Try Chrome/Safari on a device with biometric sensors (iPhone with Face ID/Touch ID, Mac with Touch ID, Windows with Windows Hello)."})]}),(0,i.jsxs)("div",{children:[i.jsx("h3",{className:"font-semibold text-blue-700",children:"NotAllowedError"}),i.jsx("p",{children:"User cancelled or timeout. Make sure to complete the biometric prompt when it appears. Check if biometric authentication is enabled in device settings."})]}),(0,i.jsxs)("div",{children:[i.jsx("h3",{className:"font-semibold text-blue-700",children:"SecurityError"}),i.jsx("p",{children:"Security requirements not met. Ensure you're using HTTPS (or localhost for development) and the domain is properly configured."})]}),(0,i.jsxs)("div",{children:[i.jsx("h3",{className:"font-semibold text-blue-700",children:"InvalidStateError"}),i.jsx("p",{children:"Authenticator already registered. Try authentication instead, or clear existing credentials and register again."})]}),(0,i.jsxs)("div",{children:[i.jsx("h3",{className:"font-semibold text-blue-700",children:"No Platform Authenticator"}),i.jsx("p",{children:"Device doesn't have a built-in biometric sensor or it's disabled. Check device settings for Face ID, Touch ID, Windows Hello, etc."})]})]})]})]})}},42576:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>s,__esModule:()=>n,default:()=>o});var i=r(68570);let a=(0,i.createProxy)(String.raw`/Users/davicho/MASTER proyectos/FacePay/src/app/test-webauthn/page.tsx`),{__esModule:n,$$typeof:s}=a;a.default;let o=(0,i.createProxy)(String.raw`/Users/davicho/MASTER proyectos/FacePay/src/app/test-webauthn/page.tsx#default`)},17602:(e,t,r)=>{"use strict";function i(e){let t=new Uint8Array(e),r="";for(let e of t)r+=String.fromCharCode(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function a(e){let t=e.replace(/-/g,"+").replace(/_/g,"/"),r=(4-t.length%4)%4,i=atob(t.padEnd(t.length+r,"=")),a=new ArrayBuffer(i.length),n=new Uint8Array(a);for(let e=0;e<i.length;e++)n[e]=i.charCodeAt(e);return a}function n(){return window?.PublicKeyCredential!==void 0&&"function"==typeof window.PublicKeyCredential}function s(e){let{id:t}=e;return{...e,id:a(t),transports:e.transports}}function o(e){return"localhost"===e||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}r.d(t,{RQ:()=>p,oz:()=>g});class l extends Error{constructor({message:e,code:t,cause:r,name:i}){super(e,{cause:r}),this.name=i??r.name,this.code=t}}class c{createNewAbortSignal(){if(this.controller){let e=Error("Cancelling existing WebAuthn API call for new one");e.name="AbortError",this.controller.abort(e)}let e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){let e=Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}let d=new c,u=["cross-platform","platform"];function h(e){if(!(!e||0>u.indexOf(e)))return e}async function p(e){var t;let r,c,u,p,g;if(!n())throw Error("WebAuthn is not supported in this browser");let b={publicKey:{...e,challenge:a(e.challenge),user:{...e.user,id:(t=e.user.id,new TextEncoder().encode(t))},excludeCredentials:e.excludeCredentials?.map(s)}};b.signal=d.createNewAbortSignal();try{r=await navigator.credentials.create(b)}catch(e){throw function({error:e,options:t}){let{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if("AbortError"===e.name){if(t.signal instanceof AbortSignal)return new l({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if("ConstraintError"===e.name){if(r.authenticatorSelection?.requireResidentKey===!0)return new l({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(r.authenticatorSelection?.userVerification==="required")return new l({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else if("InvalidStateError"===e.name)return new l({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});else if("NotAllowedError"===e.name)return new l({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});else if("NotSupportedError"===e.name)return new l(0===r.pubKeyCredParams.filter(e=>"public-key"===e.type).length?{message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}:{message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});else if("SecurityError"===e.name){let t=window.location.hostname;if(!o(t))return new l({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e});if(r.rp.id!==t)return new l({message:`The RP ID "${r.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else if("TypeError"===e.name){if(r.user.id.byteLength<1||r.user.id.byteLength>64)return new l({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if("UnknownError"===e.name)return new l({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e});return e}({error:e,options:b})}if(!r)throw Error("Registration was not completed");let{id:f,rawId:w,response:y,type:x}=r;if("function"==typeof y.getTransports&&(u=y.getTransports()),"function"==typeof y.getPublicKeyAlgorithm)try{p=y.getPublicKeyAlgorithm()}catch(e){m("getPublicKeyAlgorithm()",e)}if("function"==typeof y.getPublicKey)try{let e=y.getPublicKey();null!==e&&(g=i(e))}catch(e){m("getPublicKey()",e)}if("function"==typeof y.getAuthenticatorData)try{c=i(y.getAuthenticatorData())}catch(e){m("getAuthenticatorData()",e)}return{id:f,rawId:i(w),response:{attestationObject:i(y.attestationObject),clientDataJSON:i(y.clientDataJSON),transports:u,publicKeyAlgorithm:p,publicKey:g,authenticatorData:c},type:x,clientExtensionResults:r.getClientExtensionResults(),authenticatorAttachment:h(r.authenticatorAttachment)}}function m(e,t){console.warn(`The browser extension that intercepted this WebAuthn API call incorrectly implemented ${e}. You should report this error to them.
`,t)}async function g(e,t=!1){let r,c,u;if(!n())throw Error("WebAuthn is not supported in this browser");e.allowCredentials?.length!==0&&(r=e.allowCredentials?.map(s));let p={...e,challenge:a(e.challenge),allowCredentials:r},m={};if(t){if(!await function(){let e=window.PublicKeyCredential;return void 0===e.isConditionalMediationAvailable?new Promise(e=>e(!1)):e.isConditionalMediationAvailable()}())throw Error("Browser does not support WebAuthn autofill");if(document.querySelectorAll("input[autocomplete$='webauthn']").length<1)throw Error('No <input> with "webauthn" as the only or last value in its `autocomplete` attribute was detected');m.mediation="conditional",p.allowCredentials=[]}m.publicKey=p,m.signal=d.createNewAbortSignal();try{c=await navigator.credentials.get(m)}catch(e){throw function({error:e,options:t}){let{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if("AbortError"===e.name){if(t.signal instanceof AbortSignal)return new l({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if("NotAllowedError"===e.name)return new l({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});else if("SecurityError"===e.name){let t=window.location.hostname;if(!o(t))return new l({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e});if(r.rpId!==t)return new l({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else if("UnknownError"===e.name)return new l({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e});return e}({error:e,options:m})}if(!c)throw Error("Authentication was not completed");let{id:g,rawId:b,response:f,type:w}=c;if(f.userHandle){var y;y=f.userHandle,u=new TextDecoder("utf-8").decode(y)}return{id:g,rawId:i(b),response:{authenticatorData:i(f.authenticatorData),clientDataJSON:i(f.clientDataJSON),signature:i(f.signature),userHandle:u},type:w,clientExtensionResults:c.getClientExtensionResults(),authenticatorAttachment:h(c.authenticatorAttachment)}}}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),i=t.X(0,[8948,4185,5832,6402],()=>r(21881));module.exports=i})();