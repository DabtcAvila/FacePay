"use strict";(()=>{var e={};e.id=8829,e.ids=[8829],e.modules={53524:e=>{e.exports=require("@prisma/client")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},51962:(e,t,a)=>{a.r(t),a.d(t,{originalPathname:()=>A,patchFetch:()=>x,requestAsyncStorage:()=>w,routeModule:()=>v,serverHooks:()=>R,staticGenerationAsyncStorage:()=>T});var r={};a.r(r),a.d(r,{GET:()=>y,HEAD:()=>g,dynamic:()=>f});var n=a(49303),s=a(88716),o=a(60670),i=a(87070),u=a(13538);async function l(){let e=Date.now();try{await u._B.$queryRaw`SELECT 1`;let t=Date.now()-e;return{name:"database",status:t<1e3?"healthy":"degraded",responseTime:t,details:{type:"PostgreSQL",connectionPool:"active"}}}catch(t){return{name:"database",status:"unhealthy",responseTime:Date.now()-e,error:t.message}}}async function h(){try{if("undefined"==typeof process||!process.memoryUsage)return{name:"memory",status:"healthy",details:{message:"Memory monitoring not available in this environment"}};{let e=process.memoryUsage(),t=Math.round(e.heapUsed/1024/1024),a=Math.round(e.heapTotal/1024/1024),r=Math.round(e.heapUsed/e.heapTotal*100);return{name:"memory",status:r>90?"unhealthy":r>80?"degraded":"healthy",details:{heapUsedMB:t,heapTotalMB:a,heapUsagePercent:r,rss:Math.round(e.rss/1024/1024),external:Math.round(e.external/1024/1024)}}}}catch(e){return{name:"memory",status:"unhealthy",error:e.message}}}async function c(){try{if("undefined"!=typeof process&&process.cwd)return{name:"disk",status:"healthy",details:{cwd:process.cwd(),platform:process.platform,arch:process.arch}};return{name:"disk",status:"healthy",details:{message:"Disk monitoring not available in this environment"}}}catch(e){return{name:"disk",status:"unhealthy",error:e.message}}}async function d(){let e=[];for(let t of[{name:"stripe",url:"https://api.stripe.com/v1"}]){let a=Date.now();try{let r=new AbortController,n=setTimeout(()=>r.abort(),5e3),s=await fetch(t.url,{method:"HEAD",signal:r.signal});clearTimeout(n);let o=Date.now()-a;e.push({name:t.name,status:s.ok?"healthy":"degraded",responseTime:o,details:{statusCode:s.status,url:t.url}})}catch(r){e.push({name:t.name,status:"unhealthy",responseTime:Date.now()-a,error:r.message})}}return e}async function m(){try{let e=["DATABASE_URL","NEXTAUTH_SECRET","NEXTAUTH_URL"].filter(e=>!process.env[e]);return{name:"environment",status:0===e.length?"healthy":"unhealthy",details:{nodeVersion:process.version,nodeEnv:"production",missingVars:e.length>0?e:void 0,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone}}}catch(e){return{name:"environment",status:"unhealthy",error:e.message}}}function p(){return"undefined"!=typeof process&&process.uptime?Math.floor(process.uptime()):0}async function y(){let e=Date.now();try{let[t,a,r,n,...s]=await Promise.all([l(),h(),c(),m(),...await d()]),o=[t,a,r,n,...s],u={healthy:o.filter(e=>"healthy"===e.status).length,degraded:o.filter(e=>"degraded"===e.status).length,unhealthy:o.filter(e=>"unhealthy"===e.status).length,total:o.length},y=function(e){let t=e.filter(e=>"unhealthy"===e.status),a=e.filter(e=>"degraded"===e.status);return t.length>0?"unhealthy":a.length>0?"degraded":"healthy"}(o),g=Date.now()-e,f={status:y,timestamp:new Date().toISOString(),service:"FacePay API",version:"1.0.0",environment:"production",uptime:p(),checks:o,summary:u};return i.NextResponse.json(f,{status:"healthy"===y?200:"degraded"===y?200:503,headers:{"Content-Type":"application/json","Cache-Control":"no-cache, no-store, must-revalidate","X-Response-Time":`${g}ms`}})}catch(a){let t={status:"unhealthy",timestamp:new Date().toISOString(),service:"FacePay API",version:"1.0.0",environment:"production",uptime:p(),checks:[{name:"health_system",status:"unhealthy",error:a.message}],summary:{healthy:0,degraded:0,unhealthy:1,total:1}};return i.NextResponse.json(t,{status:503,headers:{"Content-Type":"application/json","Cache-Control":"no-cache, no-store, must-revalidate","X-Response-Time":`${Date.now()-e}ms`}})}}async function g(){return new i.NextResponse(null,{status:200,headers:{"Cache-Control":"no-cache, no-store, must-revalidate"}})}let f="force-dynamic",v=new n.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/health/route",pathname:"/api/health",filename:"route",bundlePath:"app/api/health/route"},resolvedPagePath:"/Users/davicho/MASTER proyectos/FacePay/src/app/api/health/route.ts",nextConfigOutput:"standalone",userland:r}),{requestAsyncStorage:w,staticGenerationAsyncStorage:T,serverHooks:R}=v,A="/api/health/route";function x(){return(0,o.patchFetch)({serverHooks:R,staticGenerationAsyncStorage:T})}},13538:(e,t,a)=>{a.d(t,{_B:()=>o});var r=a(53524);let n=globalThis,s=process.env.DATABASE_URL,o=n.prisma??=new r.PrismaClient({log:["error","warn"],datasources:{db:{url:s}},...!1,errorFormat:"minimal"});o.$on("query",e=>{e.duration>1e3&&console.warn(`[SLOW QUERY] ${e.duration}ms: ${e.query}`)}),o.$on("error",e=>{console.error("[PRISMA ERROR]:",e)}),process.on("beforeExit",async()=>{await o.$disconnect()}),process.on("SIGINT",async()=>{await o.$disconnect(),process.exit(0)}),process.on("SIGTERM",async()=>{await o.$disconnect(),process.exit(0)})}};var t=require("../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[8948,5972],()=>a(51962));module.exports=r})();